/*! For license information please see createPengguna.bundle.js.LICENSE.txt */
(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();const t=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&i+1<e.length&&56320==(64512&e.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&e.charCodeAt(++i)),t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128)}return t},n={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let t=0;t<e.length;t+=3){const r=e[t],s=t+1<e.length,o=s?e[t+1]:0,a=t+2<e.length,c=a?e[t+2]:0,l=r>>2,u=(3&r)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(h=64)),i.push(n[l],n[u],n[h],n[d])}return i.join("")},encodeString(e,n){return this.HAS_NATIVE_SUPPORT&&!n?btoa(e):this.encodeByteArray(t(e),n)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,i=0;for(;n<e.length;){const r=e[n++];if(r<128)t[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=e[n++];t[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){const s=((7&r)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[i++]=String.fromCharCode(55296+(s>>10)),t[i++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){const s=n[e.charAt(t++)],o=t<e.length?n[e.charAt(t)]:0;++t;const a=t<e.length?n[e.charAt(t)]:64;++t;const c=t<e.length?n[e.charAt(t)]:64;if(++t,null==s||null==o||null==a||null==c)throw new i;const l=s<<2|o>>4;if(r.push(l),64!==a){const e=o<<4&240|a>>2;if(r.push(e),64!==c){const e=a<<6&192|c;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class i extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const r=function(e){return function(e){const i=t(e);return n.encodeByteArray(i,!0)}(e).replace(/\./g,"")},s=function(e){try{return n.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null},o=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==e.g)return e.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const e=process.env.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}const t=e&&s(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},a=e=>{var t,n;return null===(n=null===(t=o())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},c=()=>{var e;return null===(e=o())||void 0===e?void 0:e.config},l=e=>{var t;return null===(t=o())||void 0===t?void 0:t[`_${e}`]};class u{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function h(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function d(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function f(){try{return"object"==typeof indexedDB}catch(e){return!1}}function p(){return new Promise(((e,t)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),e(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var e;t((null===(e=r.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))}class g extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,g.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,m.prototype.create)}}class m{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,r=this.errors[e],s=r?function(e,t){return e.replace(y,((e,n)=>{const i=t[n];return null!=i?String(i):`<${n}?>`}))}(r,n):"Error",o=`${this.serviceName}: ${s} (${i}).`;return new g(i,o,n)}}const y=/\{\$([^}]+)}/g;function v(e,t){if(e===t)return!0;const n=Object.keys(e),i=Object.keys(t);for(const r of n){if(!i.includes(r))return!1;const n=e[r],s=t[r];if(w(n)&&w(s)){if(!v(n,s))return!1}else if(n!==s)return!1}for(const e of i)if(!n.includes(e))return!1;return!0}function w(e){return null!==e&&"object"==typeof e}function I(e){const t=[];for(const[n,i]of Object.entries(e))Array.isArray(i)?i.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}function b(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,i]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(i)}})),t}function E(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class T{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let i;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");i=function(e,t){if("object"!=typeof e||null===e)return!1;for(const t of["next","error","complete"])if(t in e&&"function"==typeof e[t])return!0;return!1}(e)?e:{next:e,error:t,complete:n},void 0===i.next&&(i.next=_),void 0===i.error&&(i.error=_),void 0===i.complete&&(i.complete=_);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(e){}})),this.observers.push(i),r}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function _(){}const S=1e3,A=2,C=144e5,k=.5;function N(e,t=S,n=A){const i=t*Math.pow(n,e),r=Math.round(k*i*(Math.random()-.5)*2);return Math.min(C,i+r)}function D(e){return e&&e._delegate?e._delegate:e}class R{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const O="[DEFAULT]";class P{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new u;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),i=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(i)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:O})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e=O){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e=O){return this.instances.has(e)}getOptions(e=O){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(e)&&t.resolve(i);return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=e,i===O?void 0:i),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var i;return n||null}normalizeInstanceIdentifier(e=O){return this.component?this.component.multipleInstances?e:O:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class L{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new P(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const M=[];var x,F;(F=x||(x={}))[F.DEBUG=0]="DEBUG",F[F.VERBOSE=1]="VERBOSE",F[F.INFO=2]="INFO",F[F.WARN=3]="WARN",F[F.ERROR=4]="ERROR",F[F.SILENT=5]="SILENT";const U={debug:x.DEBUG,verbose:x.VERBOSE,info:x.INFO,warn:x.WARN,error:x.ERROR,silent:x.SILENT},V=x.INFO,j={[x.DEBUG]:"log",[x.VERBOSE]:"log",[x.INFO]:"info",[x.WARN]:"warn",[x.ERROR]:"error"},B=(e,t,...n)=>{if(t<e.logLevel)return;const i=(new Date).toISOString(),r=j[t];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[r](`[${i}]  ${e.name}:`,...n)};class ${constructor(e){this.name=e,this._logLevel=V,this._logHandler=B,this._userLogHandler=null,M.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in x))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?U[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,x.DEBUG,...e),this._logHandler(this,x.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,x.VERBOSE,...e),this._logHandler(this,x.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,x.INFO,...e),this._logHandler(this,x.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,x.WARN,...e),this._logHandler(this,x.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,x.ERROR,...e),this._logHandler(this,x.ERROR,...e)}}const H=(e,t)=>t.some((t=>e instanceof t));let z,K;const q=new WeakMap,G=new WeakMap,W=new WeakMap,Q=new WeakMap,X=new WeakMap;let J={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return G.get(e);if("objectStoreNames"===t)return e.objectStoreNames||W.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Z(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Y(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(K||(K=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(ee(this),e),Z(q.get(this))}:function(...e){return Z(t.apply(ee(this),e))}:function(e,...n){const i=t.call(ee(this),e,...n);return W.set(i,e.sort?e.sort():[e]),Z(i)}:(e instanceof IDBTransaction&&function(e){if(G.has(e))return;const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",s),e.removeEventListener("abort",s)},r=()=>{t(),i()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",r),e.addEventListener("error",s),e.addEventListener("abort",s)}));G.set(e,t)}(e),H(e,z||(z=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,J):e);var t}function Z(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("success",r),e.removeEventListener("error",s)},r=()=>{t(Z(e.result)),i()},s=()=>{n(e.error),i()};e.addEventListener("success",r),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&q.set(t,e)})).catch((()=>{})),X.set(t,e),t}(e);if(Q.has(e))return Q.get(e);const t=Y(e);return t!==e&&(Q.set(e,t),X.set(t,e)),t}const ee=e=>X.get(e),te=["get","getKey","getAll","getAllKeys","count"],ne=["put","add","delete","clear"],ie=new Map;function re(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(ie.get(t))return ie.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,r=ne.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!te.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,r?"readwrite":"readonly");let o=s.store;return i&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),r&&s.done]))[0]};return ie.set(t,s),s}var se;se=J,J={...se,get:(e,t,n)=>re(e,t)||se.get(e,t,n),has:(e,t)=>!!re(e,t)||se.has(e,t)};class oe{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const ae="@firebase/app",ce="0.9.13",le=new $("@firebase/app"),ue="[DEFAULT]",he={[ae]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},de=new Map,fe=new Map;function pe(e,t){try{e.container.addComponent(t)}catch(n){le.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function ge(e){const t=e.name;if(fe.has(t))return le.debug(`There were multiple attempts to register component ${t}.`),!1;fe.set(t,e);for(const t of de.values())pe(t,e);return!0}function me(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}const ye=new m("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class ve{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new R("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ye.create("app-deleted",{appName:this._name})}}const we="9.23.0";function Ie(e,t={}){let n=e;"object"!=typeof t&&(t={name:t});const i=Object.assign({name:ue,automaticDataCollectionEnabled:!1},t),r=i.name;if("string"!=typeof r||!r)throw ye.create("bad-app-name",{appName:String(r)});if(n||(n=c()),!n)throw ye.create("no-options");const s=de.get(r);if(s){if(v(n,s.options)&&v(i,s.config))return s;throw ye.create("duplicate-app",{appName:r})}const o=new L(r);for(const e of fe.values())o.addComponent(e);const a=new ve(n,i,o);return de.set(r,a),a}function be(e=ue){const t=de.get(e);if(!t&&e===ue&&c())return Ie();if(!t)throw ye.create("no-app",{appName:e});return t}function Ee(e,t,n){var i;let r=null!==(i=he[e])&&void 0!==i?i:e;n&&(r+=`-${n}`);const s=r.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${r}" with version "${t}":`];return s&&e.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void le.warn(e.join(" "))}ge(new R(`${r}-version`,(()=>({library:r,version:t})),"VERSION"))}const Te="firebase-heartbeat-database",_e=1,Se="firebase-heartbeat-store";let Ae=null;function Ce(){return Ae||(Ae=function(e,t,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(e,t),a=Z(o);return i&&o.addEventListener("upgradeneeded",(e=>{i(Z(o.result),e.oldVersion,e.newVersion,Z(o.transaction),e)})),n&&o.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{s&&e.addEventListener("close",(()=>s())),r&&e.addEventListener("versionchange",(e=>r(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}(Te,_e,{upgrade:(e,t)=>{0===t&&e.createObjectStore(Se)}}).catch((e=>{throw ye.create("idb-open",{originalErrorMessage:e.message})}))),Ae}async function ke(e,t){try{const n=(await Ce()).transaction(Se,"readwrite"),i=n.objectStore(Se);await i.put(t,Ne(e)),await n.done}catch(e){if(e instanceof g)le.warn(e.message);else{const t=ye.create("idb-set",{originalErrorMessage:null==e?void 0:e.message});le.warn(t.message)}}}function Ne(e){return`${e.name}!${e.options.appId}`}class De{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Oe(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=Re();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==t&&!this._heartbeatsCache.heartbeats.some((e=>e.date===t)))return this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const e=Re(),{heartbeatsToSend:t,unsentEntries:n}=function(e,t=1024){const n=[];let i=e.slice();for(const r of e){const e=n.find((e=>e.agent===r.agent));if(e){if(e.dates.push(r.date),Pe(n)>t){e.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),Pe(n)>t){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),i=r(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function Re(){return(new Date).toISOString().substring(0,10)}class Oe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!f()&&p().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=await Ce();return await t.transaction(Se).objectStore(Se).get(Ne(e))}catch(e){if(e instanceof g)le.warn(e.message);else{const t=ye.create("idb-get",{originalErrorMessage:null==e?void 0:e.message});le.warn(t.message)}}}(this.app);return e||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return ke(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return ke(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Pe(e){return r(JSON.stringify({version:2,heartbeats:e})).length}ge(new R("platform-logger",(e=>new oe(e)),"PRIVATE")),ge(new R("heartbeat",(e=>new De(e)),"PRIVATE")),Ee(ae,ce,""),Ee(ae,ce,"esm2017"),Ee("fire-js",""),Ee("firebase","9.23.0","app");const Le=(e,t)=>t.some((t=>e instanceof t));let Me,xe;const Fe=new WeakMap,Ue=new WeakMap,Ve=new WeakMap,je=new WeakMap,Be=new WeakMap;let $e={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Ue.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Ve.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ze(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function He(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(xe||(xe=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(Ke(this),e),ze(Fe.get(this))}:function(...e){return ze(t.apply(Ke(this),e))}:function(e,...n){const i=t.call(Ke(this),e,...n);return Ve.set(i,e.sort?e.sort():[e]),ze(i)}:(e instanceof IDBTransaction&&function(e){if(Ue.has(e))return;const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",s),e.removeEventListener("abort",s)},r=()=>{t(),i()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",r),e.addEventListener("error",s),e.addEventListener("abort",s)}));Ue.set(e,t)}(e),Le(e,Me||(Me=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,$e):e);var t}function ze(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("success",r),e.removeEventListener("error",s)},r=()=>{t(ze(e.result)),i()},s=()=>{n(e.error),i()};e.addEventListener("success",r),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&Fe.set(t,e)})).catch((()=>{})),Be.set(t,e),t}(e);if(je.has(e))return je.get(e);const t=He(e);return t!==e&&(je.set(e,t),Be.set(t,e)),t}const Ke=e=>Be.get(e),qe=["get","getKey","getAll","getAllKeys","count"],Ge=["put","add","delete","clear"],We=new Map;function Qe(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(We.get(t))return We.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,r=Ge.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!qe.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,r?"readwrite":"readonly");let o=s.store;return i&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),r&&s.done]))[0]};return We.set(t,s),s}$e=(e=>({...e,get:(t,n,i)=>Qe(t,n)||e.get(t,n,i),has:(t,n)=>!!Qe(t,n)||e.has(t,n)}))($e);const Xe="@firebase/installations",Je="0.6.4",Ye=1e4,Ze=`w:${Je}`,et="FIS_v2",tt="https://firebaseinstallations.googleapis.com/v1",nt=36e5,it=new m("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function rt(e){return e instanceof g&&e.code.includes("request-failed")}function st({projectId:e}){return`${tt}/projects/${e}/installations`}function ot(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function at(e,t){const n=(await t.json()).error;return it.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function ct({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}async function lt(e){const t=await e();return t.status>=500&&t.status<600?e():t}function ut(e){return new Promise((t=>{setTimeout(t,e)}))}const ht=/^[cdef][\w-]{21}$/,dt="";function ft(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){var t;return(t=e,btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22)}(e);return ht.test(t)?t:dt}catch(e){return dt}}function pt(e){return`${e.appName}!${e.appId}`}const gt=new Map;function mt(e,t){const n=pt(e);yt(n,t),function(e,t){const n=(!vt&&"BroadcastChannel"in self&&(vt=new BroadcastChannel("[Firebase] FID Change"),vt.onmessage=e=>{yt(e.data.key,e.data.fid)}),vt);n&&n.postMessage({key:e,fid:t}),0===gt.size&&vt&&(vt.close(),vt=null)}(n,t)}function yt(e,t){const n=gt.get(e);if(n)for(const e of n)e(t)}let vt=null;const wt="firebase-installations-database",It=1,bt="firebase-installations-store";let Et=null;function Tt(){return Et||(Et=function(e,t,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(e,t),a=ze(o);return i&&o.addEventListener("upgradeneeded",(e=>{i(ze(o.result),e.oldVersion,e.newVersion,ze(o.transaction))})),n&&o.addEventListener("blocked",(()=>n())),a.then((e=>{s&&e.addEventListener("close",(()=>s())),r&&e.addEventListener("versionchange",(()=>r()))})).catch((()=>{})),a}(wt,It,{upgrade:(e,t)=>{0===t&&e.createObjectStore(bt)}})),Et}async function _t(e,t){const n=pt(e),i=(await Tt()).transaction(bt,"readwrite"),r=i.objectStore(bt),s=await r.get(n);return await r.put(t,n),await i.done,s&&s.fid===t.fid||mt(e,t.fid),t}async function St(e){const t=pt(e),n=(await Tt()).transaction(bt,"readwrite");await n.objectStore(bt).delete(t),await n.done}async function At(e,t){const n=pt(e),i=(await Tt()).transaction(bt,"readwrite"),r=i.objectStore(bt),s=await r.get(n),o=t(s);return void 0===o?await r.delete(n):await r.put(o,n),await i.done,!o||s&&s.fid===o.fid||mt(e,o.fid),o}async function Ct(e){let t;const n=await At(e.appConfig,(n=>{const i=function(e){return Dt(e||{fid:ft(),registrationStatus:0})}(n),r=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(it.create("app-offline"))};const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},i=async function(e,t){try{const n=await async function({appConfig:e,heartbeatServiceProvider:t},{fid:n}){const i=st(e),r=ct(e),s=t.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&r.append("x-firebase-client",e)}const o={fid:n,authVersion:et,appId:e.appId,sdkVersion:Ze},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await lt((()=>fetch(i,a)));if(c.ok){const e=await c.json();return{fid:e.fid||n,registrationStatus:2,refreshToken:e.refreshToken,authToken:ot(e.authToken)}}throw await at("Create Installation",c)}(e,t);return _t(e.appConfig,n)}catch(n){throw rt(n)&&409===n.customData.serverCode?await St(e.appConfig):await _t(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:i}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:kt(e)}:{installationEntry:t}}(e,i);return t=r.registrationPromise,r.installationEntry}));return n.fid===dt?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function kt(e){let t=await Nt(e.appConfig);for(;1===t.registrationStatus;)await ut(100),t=await Nt(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await Ct(e);return n||t}return t}function Nt(e){return At(e,(e=>{if(!e)throw it.create("installation-not-found");return Dt(e)}))}function Dt(e){return 1===(t=e).registrationStatus&&t.registrationTime+Ye<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function Rt({appConfig:e,heartbeatServiceProvider:t},n){const i=function(e,{fid:t}){return`${st(e)}/${t}/authTokens:generate`}(e,n),r=function(e,{refreshToken:t}){const n=ct(e);return n.append("Authorization",function(e){return`${et} ${e}`}(t)),n}(e,n),s=t.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&r.append("x-firebase-client",e)}const o={installation:{sdkVersion:Ze,appId:e.appId}},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await lt((()=>fetch(i,a)));if(c.ok)return ot(await c.json());throw await at("Generate Auth Token",c)}async function Ot(e,t=!1){let n;const i=await At(e.appConfig,(i=>{if(!Lt(i))throw it.create("not-registered");const r=i.authToken;if(!t&&(2===(s=r).requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+nt}(s)))return i;var s;if(1===r.requestStatus)return n=async function(e,t){let n=await Pt(e.appConfig);for(;1===n.authToken.requestStatus;)await ut(100),n=await Pt(e.appConfig);const i=n.authToken;return 0===i.requestStatus?Ot(e,t):i}(e,t),i;{if(!navigator.onLine)throw it.create("app-offline");const t=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(i);return n=async function(e,t){try{const n=await Rt(e,t),i=Object.assign(Object.assign({},t),{authToken:n});return await _t(e.appConfig,i),n}catch(n){if(!rt(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await _t(e.appConfig,n)}else await St(e.appConfig);throw n}}(e,t),t}}));return n?await n:i.authToken}function Pt(e){return At(e,(e=>{if(!Lt(e))throw it.create("not-registered");return 1===(t=e.authToken).requestStatus&&t.requestTime+Ye<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var t}))}function Lt(e){return void 0!==e&&2===e.registrationStatus}function Mt(e){return it.create("missing-app-config-values",{valueName:e})}const xt="installations";ge(new R(xt,(e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw Mt("App Configuration");if(!e.name)throw Mt("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw Mt(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:me(t,"heartbeat"),_delete:()=>Promise.resolve()}}),"PUBLIC")),ge(new R("installations-internal",(e=>{const t=me(e.getProvider("app").getImmediate(),xt).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:i}=await Ct(t);return i?i.catch(console.error):Ot(t).catch(console.error),n.fid}(t),getToken:e=>async function(e,t=!1){const n=e;return await async function(e){const{registrationPromise:t}=await Ct(e);t&&await t}(n),(await Ot(n,t)).token}(t,e)}}),"PRIVATE")),Ee(Xe,Je),Ee(Xe,Je,"esm2017");const Ft="analytics",Ut="firebase_id",Vt="origin",jt=6e4,Bt="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",$t="https://www.googletagmanager.com/gtag/js",Ht=new $("@firebase/analytics"),zt=new m("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function Kt(e){if(!e.startsWith($t)){const t=zt.create("invalid-gtag-resource",{gtagURL:e});return Ht.warn(t.message),""}return e}function qt(e){return Promise.all(e.map((e=>e.catch((e=>e)))))}const Gt=30,Wt=new class{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function Qt(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function Xt(e,t=Wt,n){const{appId:i,apiKey:r,measurementId:s}=e.options;if(!i)throw zt.create("no-app-id");if(!r){if(s)return{measurementId:s,appId:i};throw zt.create("no-api-key")}const o=t.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Yt;return setTimeout((async()=>{a.abort()}),void 0!==n?n:jt),Jt({appId:i,apiKey:r,measurementId:s},o,a,t)}async function Jt(e,{throttleEndTimeMillis:t,backoffCount:n},i,r=Wt){var s;const{appId:o,measurementId:a}=e;try{await function(e,t){return new Promise(((n,i)=>{const r=Math.max(t-Date.now(),0),s=setTimeout(n,r);e.addEventListener((()=>{clearTimeout(s),i(zt.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(i,t)}catch(e){if(a)return Ht.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${null==e?void 0:e.message}]`),{appId:o,measurementId:a};throw e}try{const t=await async function(e){var t;const{appId:n,apiKey:i}=e,r={method:"GET",headers:Qt(i)},s=Bt.replace("{app-id}",n),o=await fetch(s,r);if(200!==o.status&&304!==o.status){let e="";try{const n=await o.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(e){}throw zt.create("config-fetch-failed",{httpStatus:o.status,responseMessage:e})}return o.json()}(e);return r.deleteThrottleMetadata(o),t}catch(t){const c=t;if(!function(e){if(!(e instanceof g&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(c)){if(r.deleteThrottleMetadata(o),a)return Ht.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${null==c?void 0:c.message}]`),{appId:o,measurementId:a};throw t}const l=503===Number(null===(s=null==c?void 0:c.customData)||void 0===s?void 0:s.httpStatus)?N(n,r.intervalMillis,Gt):N(n,r.intervalMillis),u={throttleEndTimeMillis:Date.now()+l,backoffCount:n+1};return r.setThrottleMetadata(o,u),Ht.debug(`Calling attemptFetch again in ${l} millis`),Jt(e,u,i,r)}}class Yt{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}let Zt,en;async function tn(e,t,n,i,r,s,o){var a;const c=Xt(e);c.then((t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&Ht.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((e=>Ht.error(e))),t.push(c);const l=async function(){if(!f())return Ht.warn(zt.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await p()}catch(e){return Ht.warn(zt.create("indexeddb-unavailable",{errorInfo:null==e?void 0:e.toString()}).message),!1}return!0}().then((e=>e?i.getId():void 0)),[u,h]=await Promise.all([c,l]);(function(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes($t)&&n.src.includes(e))return n;return null})(s)||function(e,t){const n=function(e,t){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy("firebase-js-sdk-policy",t)),n}(0,{createScriptURL:Kt}),i=document.createElement("script"),r=`${$t}?l=${e}&id=${t}`;i.src=n?null==n?void 0:n.createScriptURL(r):r,i.async=!0,document.head.appendChild(i)}(s,u.measurementId),en&&(r("consent","default",en),en=void 0),r("js",new Date);const d=null!==(a=null==o?void 0:o.config)&&void 0!==a?a:{};return d[Vt]="firebase",d.update=!0,null!=h&&(d[Ut]=h),r("config",u.measurementId,d),Zt&&(r("set",Zt),Zt=void 0),u.measurementId}class nn{constructor(e){this.app=e}_delete(){return delete rn[this.app.options.appId],Promise.resolve()}}let rn={},sn=[];const on={};let an,cn,ln="dataLayer",un=!1;function hn(e,t,n){!function(){const e=[];if(d()&&e.push("This is a browser extension environment."),"undefined"!=typeof navigator&&navigator.cookieEnabled||e.push("Cookies are not available."),e.length>0){const t=e.map(((e,t)=>`(${t+1}) ${e}`)).join(" "),n=zt.create("invalid-analytics-context",{errorInfo:t});Ht.warn(n.message)}}();const i=e.options.appId;if(!i)throw zt.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw zt.create("no-api-key");Ht.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=rn[i])throw zt.create("already-exists",{id:i});if(!un){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(ln);const{wrappedGtag:e,gtagCore:t}=function(e,t,n,i,r){let s=function(...e){window[i].push(arguments)};return window[r]&&"function"==typeof window[r]&&(s=window[r]),window[r]=function(e,t,n,i){return async function(r,...s){try{if("event"===r){const[i,r]=s;await async function(e,t,n,i,r){try{let s=[];if(r&&r.send_to){let e=r.send_to;Array.isArray(e)||(e=[e]);const i=await qt(n);for(const n of e){const e=i.find((e=>e.measurementId===n)),r=e&&t[e.appId];if(!r){s=[];break}s.push(r)}}0===s.length&&(s=Object.values(t)),await Promise.all(s),e("event",i,r||{})}catch(e){Ht.error(e)}}(e,t,n,i,r)}else if("config"===r){const[r,o]=s;await async function(e,t,n,i,r,s){const o=i[r];try{if(o)await t[o];else{const e=(await qt(n)).find((e=>e.measurementId===r));e&&await t[e.appId]}}catch(e){Ht.error(e)}e("config",r,s)}(e,t,n,i,r,o)}else if("consent"===r){const[t]=s;e("consent","update",t)}else if("get"===r){const[t,n,i]=s;e("get",t,n,i)}else if("set"===r){const[t]=s;e("set",t)}else e(r,...s)}catch(e){Ht.error(e)}}}(s,e,t,n),{gtagCore:s,wrappedGtag:window[r]}}(rn,sn,on,ln,"gtag");cn=e,an=t,un=!0}return rn[i]=tn(e,sn,on,t,an,ln,n),new nn(e)}const dn="@firebase/analytics",fn="0.10.0";function pn(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}ge(new R(Ft,((e,{options:t})=>hn(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t)),"PUBLIC")),ge(new R("analytics-internal",(function(e){try{const t=e.getProvider(Ft).getImmediate();return{logEvent:(e,n,i)=>function(e,t,n,i){e=D(e),async function(e,t,n,i,r){if(r&&r.global)e("event",n,i);else{const r=await t;e("event",n,Object.assign(Object.assign({},i),{send_to:r}))}}(cn,rn[e.app.options.appId],t,n,i).catch((e=>Ht.error(e)))}(t,e,n,i)}}catch(e){throw zt.create("interop-component-reg-failed",{reason:e})}}),"PRIVATE")),Ee(dn,fn),Ee(dn,fn,"esm2017"),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;const gn=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},mn=new m("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),yn=new $("@firebase/auth");function vn(e,...t){yn.logLevel<=x.ERROR&&yn.error(`Auth (${we}): ${e}`,...t)}function wn(e,...t){throw bn(e,...t)}function In(e,...t){return bn(e,...t)}function bn(e,...t){if("string"!=typeof e){const n=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(n,...i)}return mn.create(e,...t)}function En(e,t,...n){if(!e)throw bn(t,...n)}function Tn(e){const t="INTERNAL ASSERTION FAILED: "+e;throw vn(t),new Error(t)}function _n(e,t){e||Tn(t)}function Sn(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function An(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class Cn{constructor(e,t){this.shortDelay=e,this.longDelay=t,_n(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(h())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===An()||"https:"===An()||d()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function kn(e,t){_n(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class Nn{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void Tn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void Tn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void Tn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Dn={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Rn=new Cn(3e4,6e4);function On(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Pn(e,t,n,i,r={}){return Ln(e,r,(async()=>{let r={},s={};i&&("GET"===t?s=i:r={body:JSON.stringify(i)});const o=I(Object.assign({key:e.config.apiKey},s)).slice(1),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode),Nn.fetch()(xn(e,e.config.apiHost,n,o),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},r))}))}async function Ln(e,t,n){e._canInitEmulator=!1;const i=Object.assign(Object.assign({},Dn),t);try{const t=new Fn(e),r=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await r.json();if("needConfirmation"in s)throw Un(e,"account-exists-with-different-credential",s);if(r.ok&&!("errorMessage"in s))return s;{const t=r.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Un(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw Un(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw Un(e,"user-disabled",s);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw function(e,t,n){const i=Object.assign(Object.assign({},gn()),{[t]:n});return new m("auth","Firebase",i).create(t,{appName:e.name})}(e,a,o);wn(e,a)}}catch(t){if(t instanceof g)throw t;wn(e,"network-request-failed",{message:String(t)})}}async function Mn(e,t,n,i,r={}){const s=await Pn(e,t,n,i,r);return"mfaPendingCredential"in s&&wn(e,"multi-factor-auth-required",{_serverResponse:s}),s}function xn(e,t,n,i){const r=`${t}${n}?${i}`;return e.config.emulator?kn(e.config,r):`${e.config.apiScheme}://${r}`}class Fn{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(In(this.auth,"network-request-failed"))),Rn.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function Un(e,t,n){const i={appName:e.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=In(e,t,i);return r.customData._tokenResponse=n,r}function Vn(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function jn(e){return 1e3*Number(e)}function Bn(e){const[t,n,i]=e.split(".");if(void 0===t||void 0===n||void 0===i)return vn("JWT malformed, contained fewer than 3 sections"),null;try{const e=s(n);return e?JSON.parse(e):(vn("Failed to decode base64 JWT payload"),null)}catch(e){return vn("Caught error parsing JWT payload as JSON",null==e?void 0:e.toString()),null}}async function $n(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof g&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class Hn{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null==e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class zn{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Vn(this.lastLoginAt),this.creationTime=Vn(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Kn(e){var t;const n=e.auth,i=await e.getIdToken(),r=await $n(e,async function(e,t){return Pn(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:i}));En(null==r?void 0:r.users.length,n,"internal-error");const s=r.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?s.providerUserInfo.map((e=>{var{providerId:t}=e,n=pn(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],a=(c=e.providerData,l=o,[...c.filter((e=>!l.some((t=>t.providerId===e.providerId)))),...l]);var c,l;const u=e.isAnonymous,h=!(e.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!u&&h,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new zn(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,f)}class qn{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){En(e.idToken,"internal-error"),En(void 0!==e.idToken,"internal-error"),En(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){const t=Bn(e);return En(t,"internal-error"),En(void 0!==t.exp,"internal-error"),En(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return En(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:r}=await async function(e,t){const n=await Ln(e,{},(async()=>{const n=I({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:r}=e.config,s=xn(e,i,"/v1/token",`key=${r}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Nn.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,i,Number(r))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:r}=t,s=new qn;return n&&(En("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),i&&(En("string"==typeof i,"internal-error",{appName:e}),s.accessToken=i),r&&(En("number"==typeof r,"internal-error",{appName:e}),s.expirationTime=r),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new qn,this.toJSON())}_performRefresh(){return Tn("not implemented")}}function Gn(e,t){En("string"==typeof e||void 0===e,"internal-error",{appName:t})}class Wn{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,r=pn(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Hn(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new zn(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await $n(this,this.stsTokenManager.getToken(this.auth,e));return En(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=D(e),i=await n.getIdToken(t),r=Bn(i);En(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const s="object"==typeof r.firebase?r.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:r,token:i,authTime:Vn(jn(r.auth_time)),issuedAtTime:Vn(jn(r.iat)),expirationTime:Vn(jn(r.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=D(e);await Kn(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(En(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Wn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){En(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Kn(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await $n(this,async function(e,t){return Pn(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,r,s,o,a,c,l;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(i=t.email)&&void 0!==i?i:void 0,d=null!==(r=t.phoneNumber)&&void 0!==r?r:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,g=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,m=null!==(c=t.createdAt)&&void 0!==c?c:void 0,y=null!==(l=t.lastLoginAt)&&void 0!==l?l:void 0,{uid:v,emailVerified:w,isAnonymous:I,providerData:b,stsTokenManager:E}=t;En(v&&E,e,"internal-error");const T=qn.fromJSON(this.name,E);En("string"==typeof v,e,"internal-error"),Gn(u,e.name),Gn(h,e.name),En("boolean"==typeof w,e,"internal-error"),En("boolean"==typeof I,e,"internal-error"),Gn(d,e.name),Gn(f,e.name),Gn(p,e.name),Gn(g,e.name),Gn(m,e.name),Gn(y,e.name);const _=new Wn({uid:v,auth:e,email:h,emailVerified:w,displayName:u,isAnonymous:I,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:T,createdAt:m,lastLoginAt:y});return b&&Array.isArray(b)&&(_.providerData=b.map((e=>Object.assign({},e)))),g&&(_._redirectEventId=g),_}static async _fromIdTokenResponse(e,t,n=!1){const i=new qn;i.updateFromServerResponse(t);const r=new Wn({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await Kn(r),r}}const Qn=new Map;function Xn(e){_n(e instanceof Function,"Expected a class definition");let t=Qn.get(e);return t?(_n(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Qn.set(e,t),t)}class Jn{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Jn.type="NONE";const Yn=Jn;function Zn(e,t,n){return`firebase:${e}:${t}:${n}`}class ei{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=Zn(this.userKey,i.apiKey,r),this.fullPersistenceKey=Zn("persistence",i.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Wn._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new ei(Xn(Yn),e,n);const i=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let r=i[0]||Xn(Yn);const s=Zn(n,e.config.apiKey,e.name);let o=null;for(const n of t)try{const t=await n._get(s);if(t){const i=Wn._fromJSON(e,t);n!==r&&(o=i),r=n;break}}catch(e){}const a=i.filter((e=>e._shouldAllowMigration));return r._shouldAllowMigration&&a.length?(r=a[0],o&&await r._set(s,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==r)try{await e._remove(s)}catch(e){}}))),new ei(r,e,n)):new ei(r,e,n)}}function ti(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(si(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(ni(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(ai(t))return"Blackberry";if(ci(t))return"Webos";if(ii(t))return"Safari";if((t.includes("chrome/")||ri(t))&&!t.includes("edge/"))return"Chrome";if(oi(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function ni(e=h()){return/firefox\//i.test(e)}function ii(e=h()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function ri(e=h()){return/crios\//i.test(e)}function si(e=h()){return/iemobile/i.test(e)}function oi(e=h()){return/android/i.test(e)}function ai(e=h()){return/blackberry/i.test(e)}function ci(e=h()){return/webos/i.test(e)}function li(e=h()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function ui(e=h()){return li(e)||oi(e)||ci(e)||ai(e)||/windows phone/i.test(e)||si(e)}function hi(e,t=[]){let n;switch(e){case"Browser":n=ti(h());break;case"Worker":n=`${ti(h())}-${e}`;break;default:n=e}const i=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${we}/${i}`}async function di(e,t){return Pn(e,"GET","/v2/recaptchaConfig",On(e,t))}function fi(e){return void 0!==e&&void 0!==e.enterprise}class pi{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some((e=>"EMAIL_PASSWORD_PROVIDER"===e.provider&&"OFF"!==e.enforcementState))}}function gi(e){return new Promise(((t,n)=>{const i=document.createElement("script");var r,s;i.setAttribute("src",e),i.onload=t,i.onerror=e=>{const t=In("internal-error");t.customData=e,n(t)},i.type="text/javascript",i.charset="UTF-8",(null!==(s=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==s?s:document).appendChild(i)}))}function mi(e){return`__${e}${Math.floor(1e6*Math.random())}`}class yi{constructor(e){this.type="recaptcha-enterprise",this.auth=bi(e)}async verify(e="verify",t=!1){function n(t,n,i){const r=window.grecaptcha;fi(r)?r.enterprise.ready((()=>{r.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n("NO_RECAPTCHA")}))})):i(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((e,i)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{di(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((i=>{if(void 0!==i.recaptchaKey){const n=new pi(i);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((r=>{if(!t&&fi(window.grecaptcha))n(r,e,i);else{if("undefined"==typeof window)return void i(new Error("RecaptchaVerifier is only supported in browser"));gi("https://www.google.com/recaptcha/enterprise.js?render="+r).then((()=>{n(r,e,i)})).catch((e=>{i(e)}))}})).catch((e=>{i(e)}))}))}}async function vi(e,t,n,i=!1){const r=new yi(e);let s;try{s=await r.verify(n)}catch(e){s=await r.verify(n,!0)}const o=Object.assign({},t);return i?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}class wi{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,i)=>{try{n(e(t))}catch(e){i(e)}}));n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(e){t.reverse();for(const e of t)try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==e?void 0:e.message})}}}class Ii{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ei(this),this.idTokenSubscription=new Ei(this),this.beforeStateQueue=new wi(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=mn,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Xn(t)),this._initializationPromise=this.queue((async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await ei.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUser(e){var t;const n=await this.assertedPersistence.getCurrentUser();let i=n,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null==i?void 0:i._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==s||!(null==o?void 0:o.user)||(i=o.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(e){i=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(e)))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return En(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Kn(e)}catch(e){if("auth/network-request-failed"!==(null==e?void 0:e.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?D(e):null;return t&&En(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&En(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue((async()=>{await this.assertedPersistence.setPersistence(Xn(e))}))}async initializeRecaptchaConfig(){const e=await di(this,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),t=new pi(e);null==this.tenantId?this._agentRecaptchaConfig=t:this._tenantRecaptchaConfigs[this.tenantId]=t,t.emailPasswordEnabled&&new yi(this).verify()}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new m("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Xn(e)||this._popupRedirectResolver;En(t,this,"argument-error"),this.redirectPersistenceManager=await ei.create(this,[Xn(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const r="function"==typeof t?t:t.next.bind(t),s=this._isInitialized?Promise.resolve():this._initializationPromise;return En(s,this,"internal-error"),s.then((()=>r(this.currentUser))),"function"==typeof t?e.addObserver(t,n,i):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return En(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=hi(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null==t?void 0:t.error)&&function(e,...t){yn.logLevel<=x.WARN&&yn.warn(`Auth (${we}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token}}function bi(e){return D(e)}class Ei{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new T(e,void 0);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return En(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Ti(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function _i(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Si{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Tn("not implemented")}_getIdTokenResponse(e){return Tn("not implemented")}_linkToIdToken(e,t){return Tn("not implemented")}_getReauthenticationResolver(e){return Tn("not implemented")}}async function Ai(e,t){return Mn(e,"POST","/v1/accounts:signInWithPassword",On(e,t))}class Ci extends Si{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Ci(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Ci(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){var t;switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};if(null===(t=e._getRecaptchaConfig())||void 0===t?void 0:t.emailPasswordEnabled){const t=await vi(e,n,"signInWithPassword");return Ai(e,t)}return Ai(e,n).catch((async t=>{if("auth/missing-recaptcha-token"===t.code){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const t=await vi(e,n,"signInWithPassword");return Ai(e,t)}return Promise.reject(t)}));case"emailLink":return async function(e,t){return Mn(e,"POST","/v1/accounts:signInWithEmailLink",On(e,t))}(e,{email:this._email,oobCode:this._password});default:wn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return async function(e,t){return Pn(e,"POST","/v1/accounts:update",t)}(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return Mn(e,"POST","/v1/accounts:signInWithEmailLink",On(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:wn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function ki(e,t){return Mn(e,"POST","/v1/accounts:signInWithIdp",On(e,t))}class Ni extends Si{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ni(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):wn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,r=pn(t,["providerId","signInMethod"]);if(!n||!i)return null;const s=new Ni(n,i);return s.idToken=r.idToken||void 0,s.accessToken=r.accessToken||void 0,s.secret=r.secret,s.nonce=r.nonce,s.pendingToken=r.pendingToken||null,s}_getIdTokenResponse(e){return ki(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,ki(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ki(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=I(t)}return e}}const Di={USER_NOT_FOUND:"user-not-found"};class Ri extends Si{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Ri({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Ri({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return Mn(e,"POST","/v1/accounts:signInWithPhoneNumber",On(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await Mn(e,"POST","/v1/accounts:signInWithPhoneNumber",On(e,t));if(n.temporaryProof)throw Un(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return Mn(e,"POST","/v1/accounts:signInWithPhoneNumber",On(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),Di)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}=e;return n||t||i||r?new Ri({verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}class Oi{constructor(e){var t,n,i,r,s,o;const a=b(E(e)),c=null!==(t=a.apiKey)&&void 0!==t?t:null,l=null!==(n=a.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=a.mode)&&void 0!==i?i:null);En(c&&l&&u,"argument-error"),this.apiKey=c,this.operation=u,this.code=l,this.continueUrl=null!==(r=a.continueUrl)&&void 0!==r?r:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=b(E(e)).link,n=t?b(E(t)).deep_link_id:null,i=b(E(e)).deep_link_id;return(i?b(E(i)).link:null)||i||n||t||e}(e);try{return new Oi(t)}catch(e){return null}}}class Pi{constructor(){this.providerId=Pi.PROVIDER_ID}static credential(e,t){return Ci._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Oi.parseLink(t);return En(n,"argument-error"),Ci._fromEmailAndCode(e,n.code,n.tenantId)}}Pi.PROVIDER_ID="password",Pi.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Pi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Li{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Mi extends Li{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class xi extends Mi{constructor(){super("facebook.com")}static credential(e){return Ni._fromParams({providerId:xi.PROVIDER_ID,signInMethod:xi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xi.credentialFromTaggedObject(e)}static credentialFromError(e){return xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return xi.credential(e.oauthAccessToken)}catch(e){return null}}}xi.FACEBOOK_SIGN_IN_METHOD="facebook.com",xi.PROVIDER_ID="facebook.com";class Fi extends Mi{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ni._fromParams({providerId:Fi.PROVIDER_ID,signInMethod:Fi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Fi.credentialFromTaggedObject(e)}static credentialFromError(e){return Fi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Fi.credential(t,n)}catch(e){return null}}}Fi.GOOGLE_SIGN_IN_METHOD="google.com",Fi.PROVIDER_ID="google.com";class Ui extends Mi{constructor(){super("github.com")}static credential(e){return Ni._fromParams({providerId:Ui.PROVIDER_ID,signInMethod:Ui.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ui.credentialFromTaggedObject(e)}static credentialFromError(e){return Ui.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Ui.credential(e.oauthAccessToken)}catch(e){return null}}}Ui.GITHUB_SIGN_IN_METHOD="github.com",Ui.PROVIDER_ID="github.com";class Vi extends Mi{constructor(){super("twitter.com")}static credential(e,t){return Ni._fromParams({providerId:Vi.PROVIDER_ID,signInMethod:Vi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Vi.credentialFromTaggedObject(e)}static credentialFromError(e){return Vi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Vi.credential(t,n)}catch(e){return null}}}Vi.TWITTER_SIGN_IN_METHOD="twitter.com",Vi.PROVIDER_ID="twitter.com";class ji{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,i=!1){const r=await Wn._fromIdTokenResponse(e,n,i),s=Bi(n);return new ji({user:r,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=Bi(n);return new ji({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function Bi(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class $i extends g{constructor(e,t,n,i){var r;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,$i.prototype),this.customData={appName:e.name,tenantId:null!==(r=e.tenantId)&&void 0!==r?r:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new $i(e,t,n,i)}}function Hi(e,t,n,i){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw $i._fromErrorAndOperation(e,n,t,i);throw n}))}new WeakMap;const zi="__sak";class Ki{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(zi,"1"),this.storage.removeItem(zi),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class qi extends Ki{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=h();return ii(e)||li(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=ui(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const i=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},r=this.storage.getItem(n);!function(){const e=h();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()||10!==document.documentMode||r===e.newValue||e.newValue===e.oldValue?i():setTimeout(i,10)}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}qi.type="LOCAL";const Gi=qi;class Wi extends Ki{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Wi.type="SESSION";const Qi=Wi;class Xi{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new Xi(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:r}=t.data,s=this.handlersMap[i];if(!(null==s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map((async e=>e(t.origin,r))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Ji(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}Xi.receivers=[];class Yi{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,s;return new Promise(((o,a)=>{const c=Ji("",20);i.port1.start();const l=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:i,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(l),r=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(r),o(t.data.response);break;default:clearTimeout(l),clearTimeout(r),a(new Error("invalid_response"))}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[i.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function Zi(){return window}function er(){return void 0!==Zi().WorkerGlobalScope&&"function"==typeof Zi().importScripts}const tr="firebaseLocalStorageDb",nr="firebaseLocalStorage",ir="fbase_key";class rr{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function sr(e,t){return e.transaction([nr],t?"readwrite":"readonly").objectStore(nr)}function or(){const e=indexedDB.open(tr,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(nr,{keyPath:ir})}catch(e){n(e)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(nr)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(tr);return new rr(e).toPromise()}(),t(await or()))}))}))}async function ar(e,t,n){const i=sr(e,!0).put({[ir]:t,value:n});return new rr(i).toPromise()}function cr(e,t){const n=sr(e,!0).delete(t);return new rr(n).toPromise()}class lr{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await or()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return er()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Xi._getInstance(er()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Yi(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&((null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}var t}async _isAvailable(){try{if(!indexedDB)return!1;const e=await or();return await ar(e,zi,"1"),await cr(e,zi),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>ar(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=sr(e,!1).get(t),i=await new rr(n).toPromise();return void 0===i?null:i.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>cr(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=sr(e,!1).getAll();return new rr(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:i,value:r}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),t.push(i));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}lr.type="LOCAL";const ur=lr;mi("rcb"),new Cn(3e4,6e4);class hr{constructor(e){this.providerId=hr.PROVIDER_ID,this.auth=bi(e)}verifyPhoneNumber(e,t){return async function(e,t,n){var i;const r=await n.verify();try{let s;if(En("string"==typeof r,e,"argument-error"),En("recaptcha"===n.type,e,"argument-error"),s="string"==typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){En("enroll"===t.type,e,"internal-error");const n=await function(e,t){return Pn(e,"POST","/v2/accounts/mfaEnrollment:start",On(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:r}});return n.phoneSessionInfo.sessionInfo}{En("signin"===t.type,e,"internal-error");const n=(null===(i=s.multiFactorHint)||void 0===i?void 0:i.uid)||s.multiFactorUid;En(n,e,"missing-multi-factor-info");const o=await function(e,t){return Pn(e,"POST","/v2/accounts/mfaSignIn:start",On(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return Pn(e,"POST","/v1/accounts:sendVerificationCode",On(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:r});return t}}finally{n._reset()}}(this.auth,e,D(t))}static credential(e,t){return Ri._fromVerification(e,t)}static credentialFromResult(e){const t=e;return hr.credentialFromTaggedObject(t)}static credentialFromError(e){return hr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?Ri._fromTokenResponse(t,n):null}}hr.PROVIDER_ID="phone",hr.PHONE_SIGN_IN_METHOD="phone";class dr extends Si{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ki(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ki(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ki(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function fr(e){return async function(e,t,n=!1){const i="signIn",r=await Hi(e,i,t),s=await ji._fromIdTokenResponse(e,i,r);return n||await e._updateCurrentUser(s.user),s}(e.auth,new dr(e),e.bypassAuthState)}function pr(e){const{auth:t,user:n}=e;return En(n,t,"internal-error"),async function(e,t,n=!1){const{auth:i}=e,r="reauthenticate";try{const s=await $n(e,Hi(i,r,t,e),n);En(s.idToken,i,"internal-error");const o=Bn(s.idToken);En(o,i,"internal-error");const{sub:a}=o;return En(e.uid===a,i,"user-mismatch"),ji._forOperation(e,r,s)}catch(e){throw"auth/user-not-found"===(null==e?void 0:e.code)&&wn(i,"user-mismatch"),e}}(n,new dr(e),e.bypassAuthState)}async function gr(e){const{auth:t,user:n}=e;return En(n,t,"internal-error"),async function(e,t,n=!1){const i=await $n(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return ji._forOperation(e,"link",i)}(n,new dr(e),e.bypassAuthState)}class mr{constructor(e,t,n,i,r=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:r,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return fr;case"linkViaPopup":case"linkViaRedirect":return gr;case"reauthViaPopup":case"reauthViaRedirect":return pr;default:wn(this.auth,"internal-error")}}resolve(e){_n(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){_n(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const yr=new Cn(2e3,1e4);class vr extends mr{constructor(e,t,n,i,r){super(e,t,i,r),this.provider=n,this.authWindow=null,this.pollId=null,vr.currentPopupAction&&vr.currentPopupAction.cancel(),vr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return En(e,this.auth,"internal-error"),e}async onExecution(){_n(1===this.filter.length,"Popup operations only handle one event");const e=Ji();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(In(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(In(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,vr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(In(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,yr.get())};e()}}vr.currentPopupAction=null;const wr="pendingRedirect",Ir=new Map;class br extends mr{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=Ir.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=function(e){return Zn(wr,e.config.apiKey,e.name)}(t),i=function(e){return Xn(e._redirectPersistence)}(e);if(!await i._isAvailable())return!1;const r="true"===await i._get(n);return await i._remove(n),r}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}Ir.set(this.auth._key(),e)}return this.bypassAuthState||Ir.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Er(e,t){Ir.set(e._key(),t)}async function Tr(e,t,n=!1){const i=bi(e),r=function(e,t){return t?Xn(t):(En(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}(i,t),s=new br(i,r,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,t)),o}class _r{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ar(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Ar(e)){const i=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(In(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Sr(e))}saveEventToCache(e){this.cachedEventUids.add(Sr(e)),this.lastProcessedEventTime=Date.now()}}function Sr(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function Ar({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}const Cr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,kr=/^https?/;function Nr(e){const t=Sn(),{protocol:n,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){const r=new URL(e);return""===r.hostname&&""===i?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!kr.test(n))return!1;if(Cr.test(e))return i===e;const r=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const Dr=new Cn(3e4,6e4);function Rr(){const e=Zi().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}let Or=null;function Pr(e){return Or=Or||function(e){return new Promise(((t,n)=>{var i,r,s;function o(){Rr(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Rr(),n(In(e,"network-request-failed"))},timeout:Dr.get()})}if(null===(r=null===(i=Zi().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=Zi().gapi)||void 0===s?void 0:s.load)){const t=mi("iframefcb");return Zi()[t]=()=>{gapi.load?o():n(In(e,"network-request-failed"))},gi(`https://apis.google.com/js/api.js?onload=${t}`).catch((e=>n(e)))}o()}})).catch((e=>{throw Or=null,e}))}(e),Or}const Lr=new Cn(5e3,15e3),Mr={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},xr=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Fr(e){const t=e.config;En(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?kn(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,i={apiKey:t.apiKey,appName:e.name,v:we},r=xr.get(e.config.apiHost);r&&(i.eid=r);const s=e._getFrameworks();return s.length&&(i.fw=s.join(",")),`${n}?${I(i).slice(1)}`}const Ur={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Vr{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}const jr=encodeURIComponent("fac");async function Br(e,t,n,i,r,s){En(e.config.authDomain,e,"auth-domain-config-required"),En(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:i,v:we,eventId:r};if(t instanceof Li){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof Mi){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const e of Object.keys(a))void 0===a[e]&&delete a[e];const c=await e._getAppCheckToken(),l=c?`#${jr}=${encodeURIComponent(c)}`:"";return`${function({config:e}){return e.emulator?kn(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${I(a).slice(1)}${l}`}const $r="webStorageSupport",Hr=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Qi,this._completeRedirectFn=Tr,this._overrideRedirectResult=Er}async _openPopup(e,t,n,i){var r;return _n(null===(r=this.eventManagers[e._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()"),function(e,t,n,i=500,r=600){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const c=Object.assign(Object.assign({},Ur),{width:i.toString(),height:r.toString(),top:s,left:o}),l=h().toLowerCase();n&&(a=ri(l)?"_blank":n),ni(l)&&(t=t||"http://localhost",c.scrollbars="yes");const u=Object.entries(c).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(function(e=h()){var t;return li(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(l)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(t||"",a),new Vr(null);const d=window.open(t||"",a,u);En(d,e,"popup-blocked");try{d.focus()}catch(e){}return new Vr(d)}(e,await Br(e,t,n,Sn(),i),Ji())}async _openRedirect(e,t,n,i){return await this._originValidation(e),r=await Br(e,t,n,Sn(),i),Zi().location.href=r,new Promise((()=>{}));var r}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(_n(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await async function(e){const t=await Pr(e),n=Zi().gapi;return En(n,e,"internal-error"),t.open({where:document.body,url:Fr(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Mr,dontclear:!0},(t=>new Promise((async(n,i)=>{await t.restyle({setHideOnLeave:!1});const r=In(e,"network-request-failed"),s=Zi().setTimeout((()=>{i(r)}),Lr.get());function o(){Zi().clearTimeout(s),n(t)}t.ping(o).then(o,(()=>{i(r)}))}))))}(e),n=new _r(e);return t.register("authEvent",(t=>(En(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:n.onEvent(t.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send($r,{type:$r},(n=>{var i;const r=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i[$r];void 0!==r&&t(!!r),wn(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e,t={}){return Pn(e,"GET","/v1/projects",t)}(e);for(const e of t)try{if(Nr(e))return}catch(e){}wn(e,"unauthorized-domain")}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ui()||ii()||li()}};var zr="@firebase/auth",Kr="0.23.2";class qr{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){En(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Gr=l("authIdTokenMaxAge")||300;let Wr=null;var Qr;Qr="Browser",ge(new R("auth",((e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),r=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=n.options;En(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:s,authDomain:o,clientPlatform:Qr,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:hi(Qr)},c=new Ii(n,i,r,a);return function(e,t){const n=(null==t?void 0:t.persistence)||[],i=(Array.isArray(n)?n:[n]).map(Xn);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(i,null==t?void 0:t.popupRedirectResolver)}(c,t),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),ge(new R("auth-internal",(e=>(e=>new qr(e))(bi(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),Ee(zr,Kr,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(Qr)),Ee(zr,Kr,"esm2017");var Xr,Jr="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Yr={},Zr=Zr||{},es=Jr||self;function ts(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function ns(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var is="closure_uid_"+(1e9*Math.random()>>>0),rs=0;function ss(e,t,n){return e.call.apply(e.bind,arguments)}function os(e,t,n){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function as(e,t,n){return(as=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ss:os).apply(null,arguments)}function cs(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function ls(e,t){function n(){}n.prototype=t.prototype,e.$=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.ac=function(e,n,i){for(var r=Array(arguments.length-2),s=2;s<arguments.length;s++)r[s-2]=arguments[s];return t.prototype[n].apply(e,r)}}function us(){this.s=this.s,this.o=this.o}us.prototype.s=!1,us.prototype.sa=function(){var e;!this.s&&(this.s=!0,this.N(),0)&&(e=this,Object.prototype.hasOwnProperty.call(e,is)&&e[is]||(e[is]=++rs))},us.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const hs=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function ds(e){const t=e.length;if(0<t){const n=Array(t);for(let i=0;i<t;i++)n[i]=e[i];return n}return[]}function fs(e,t){for(let t=1;t<arguments.length;t++){const n=arguments[t];if(ts(n)){const t=e.length||0,i=n.length||0;e.length=t+i;for(let r=0;r<i;r++)e[t+r]=n[r]}else e.push(n)}}function ps(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}ps.prototype.h=function(){this.defaultPrevented=!0};var gs=function(){if(!es.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{es.addEventListener("test",(()=>{}),t),es.removeEventListener("test",(()=>{}),t)}catch(e){}return e}();function ms(e){return/^[\s\xa0]*$/.test(e)}function ys(){var e=es.navigator;return e&&(e=e.userAgent)?e:""}function vs(e){return-1!=ys().indexOf(e)}function ws(e){return ws[" "](e),e}ws[" "]=function(){};var Is,bs,Es,Ts=vs("Opera"),_s=vs("Trident")||vs("MSIE"),Ss=vs("Edge"),As=Ss||_s,Cs=vs("Gecko")&&!(-1!=ys().toLowerCase().indexOf("webkit")&&!vs("Edge"))&&!(vs("Trident")||vs("MSIE"))&&!vs("Edge"),ks=-1!=ys().toLowerCase().indexOf("webkit")&&!vs("Edge");function Ns(){var e=es.document;return e?e.documentMode:void 0}e:{var Ds="",Rs=(bs=ys(),Cs?/rv:([^\);]+)(\)|;)/.exec(bs):Ss?/Edge\/([\d\.]+)/.exec(bs):_s?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(bs):ks?/WebKit\/(\S+)/.exec(bs):Ts?/(?:Version)[ \/]?(\S+)/.exec(bs):void 0);if(Rs&&(Ds=Rs?Rs[1]:""),_s){var Os=Ns();if(null!=Os&&Os>parseFloat(Ds)){Is=String(Os);break e}}Is=Ds}es.document&&_s?Es=Ns()||parseInt(Is,10)||void 0:Es=void 0;var Ps=Es;function Ls(e,t){if(ps.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,i=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(Cs){e:{try{ws(t.nodeName);var r=!0;break e}catch(e){}r=!1}r||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:Ms[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&Ls.$.h.call(this)}}ls(Ls,ps);var Ms={2:"touch",3:"pen",4:"mouse"};Ls.prototype.h=function(){Ls.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var xs="closure_listenable_"+(1e6*Math.random()|0),Fs=0;function Us(e,t,n,i,r){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!i,this.la=r,this.key=++Fs,this.fa=this.ia=!1}function Vs(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function js(e,t,n){for(const i in e)t.call(n,e[i],i,e)}function Bs(e){const t={};for(const n in e)t[n]=e[n];return t}const $s="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Hs(e,t){let n,i;for(let t=1;t<arguments.length;t++){for(n in i=arguments[t],i)e[n]=i[n];for(let t=0;t<$s.length;t++)n=$s[t],Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}}function zs(e){this.src=e,this.g={},this.h=0}function Ks(e,t){var n=t.type;if(n in e.g){var i,r=e.g[n],s=hs(r,t);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(Vs(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function qs(e,t,n,i){for(var r=0;r<e.length;++r){var s=e[r];if(!s.fa&&s.listener==t&&s.capture==!!n&&s.la==i)return r}return-1}zs.prototype.add=function(e,t,n,i,r){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=qs(e,t,i,r);return-1<o?(t=e[o],n||(t.ia=!1)):((t=new Us(t,this.src,s,!!i,r)).ia=n,e.push(t)),t};var Gs="closure_lm_"+(1e6*Math.random()|0),Ws={};function Qs(e,t,n,i,r){if(i&&i.once)return Js(e,t,n,i,r);if(Array.isArray(t)){for(var s=0;s<t.length;s++)Qs(e,t[s],n,i,r);return null}return n=ro(n),e&&e[xs]?e.O(t,n,ns(i)?!!i.capture:!!i,r):Xs(e,t,n,!1,i,r)}function Xs(e,t,n,i,r,s){if(!t)throw Error("Invalid event type");var o=ns(r)?!!r.capture:!!r,a=no(e);if(a||(e[Gs]=a=new zs(e)),(n=a.add(t,n,i,o,s)).proxy)return n;if(i=function(){const e=to;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=i,i.src=e,i.listener=n,e.addEventListener)gs||(r=o),void 0===r&&(r=!1),e.addEventListener(t.toString(),i,r);else if(e.attachEvent)e.attachEvent(eo(t.toString()),i);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(i)}return n}function Js(e,t,n,i,r){if(Array.isArray(t)){for(var s=0;s<t.length;s++)Js(e,t[s],n,i,r);return null}return n=ro(n),e&&e[xs]?e.P(t,n,ns(i)?!!i.capture:!!i,r):Xs(e,t,n,!0,i,r)}function Ys(e,t,n,i,r){if(Array.isArray(t))for(var s=0;s<t.length;s++)Ys(e,t[s],n,i,r);else i=ns(i)?!!i.capture:!!i,n=ro(n),e&&e[xs]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=qs(s=e.g[t],n,i,r))&&(Vs(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--))):e&&(e=no(e))&&(t=e.g[t.toString()],e=-1,t&&(e=qs(t,n,i,r)),(n=-1<e?t[e]:null)&&Zs(n))}function Zs(e){if("number"!=typeof e&&e&&!e.fa){var t=e.src;if(t&&t[xs])Ks(t.i,e);else{var n=e.type,i=e.proxy;t.removeEventListener?t.removeEventListener(n,i,e.capture):t.detachEvent?t.detachEvent(eo(n),i):t.addListener&&t.removeListener&&t.removeListener(i),(n=no(t))?(Ks(n,e),0==n.h&&(n.src=null,t[Gs]=null)):Vs(e)}}}function eo(e){return e in Ws?Ws[e]:Ws[e]="on"+e}function to(e,t){if(e.fa)e=!0;else{t=new Ls(t,this);var n=e.listener,i=e.la||e.src;e.ia&&Zs(e),e=n.call(i,t)}return e}function no(e){return(e=e[Gs])instanceof zs?e:null}var io="__closure_events_fn_"+(1e9*Math.random()>>>0);function ro(e){return"function"==typeof e?e:(e[io]||(e[io]=function(t){return e.handleEvent(t)}),e[io])}function so(){us.call(this),this.i=new zs(this),this.S=this,this.J=null}function oo(e,t){var n,i=e.J;if(i)for(n=[];i;i=i.J)n.push(i);if(e=e.S,i=t.type||t,"string"==typeof t)t=new ps(t,e);else if(t instanceof ps)t.target=t.target||e;else{var r=t;Hs(t=new ps(i,e),r)}if(r=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];r=ao(o,i,!0,t)&&r}if(r=ao(o=t.g=e,i,!0,t)&&r,r=ao(o,i,!1,t)&&r,n)for(s=0;s<n.length;s++)r=ao(o=t.g=n[s],i,!1,t)&&r}function ao(e,t,n,i){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var r=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&Ks(e.i,o),r=!1!==a.call(c,i)&&r}}return r&&!i.defaultPrevented}ls(so,us),so.prototype[xs]=!0,so.prototype.removeEventListener=function(e,t,n,i){Ys(this,e,t,n,i)},so.prototype.N=function(){if(so.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],i=0;i<n.length;i++)Vs(n[i]);delete t.g[e],t.h--}}this.J=null},so.prototype.O=function(e,t,n,i){return this.i.add(String(e),t,!1,n,i)},so.prototype.P=function(e,t,n,i){return this.i.add(String(e),t,!0,n,i)};var co=es.JSON.stringify;function lo(){var e=yo;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var uo=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new ho),(e=>e.reset()));class ho{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function fo(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function po(e){es.setTimeout((()=>{throw e}),0)}let go,mo=!1,yo=new class{constructor(){this.h=this.g=null}add(e,t){const n=uo.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},vo=()=>{const e=es.Promise.resolve(void 0);go=()=>{e.then(wo)}};var wo=()=>{for(var e;e=lo();){try{e.h.call(e.g)}catch(e){po(e)}var t=uo;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}mo=!1};function Io(e,t){so.call(this),this.h=e||1,this.g=t||es,this.j=as(this.qb,this),this.l=Date.now()}function bo(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}function Eo(e,t,n){if("function"==typeof e)n&&(e=as(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=as(e.handleEvent,e)}return 2147483647<Number(t)?-1:es.setTimeout(e,t||0)}function To(e){e.g=Eo((()=>{e.g=null,e.i&&(e.i=!1,To(e))}),e.j);const t=e.h;e.h=null,e.m.apply(null,t)}ls(Io,so),(Xr=Io.prototype).ga=!1,Xr.T=null,Xr.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),oo(this,"tick"),this.ga&&(bo(this),this.start()))}},Xr.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Xr.N=function(){Io.$.N.call(this),bo(this),delete this.g};class _o extends us{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:To(this)}N(){super.N(),this.g&&(es.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function So(e){us.call(this),this.h=e,this.g={}}ls(So,us);var Ao=[];function Co(e,t,n,i){Array.isArray(n)||(n&&(Ao[0]=n.toString()),n=Ao);for(var r=0;r<n.length;r++){var s=Qs(t,n[r],i||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function ko(e){js(e.g,(function(e,t){this.g.hasOwnProperty(t)&&Zs(e)}),e),e.g={}}function No(){this.g=!0}function Do(e,t,n,i){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var i=n[e];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return co(n)}catch(e){return t}}(e,n)+(i?" "+i:"")}))}So.prototype.N=function(){So.$.N.call(this),ko(this)},So.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},No.prototype.Ea=function(){this.g=!1},No.prototype.info=function(){};var Ro={},Oo=null;function Po(){return Oo=Oo||new so}function Lo(e){ps.call(this,Ro.Ta,e)}function Mo(e){const t=Po();oo(t,new Lo(t))}function xo(e,t){ps.call(this,Ro.STAT_EVENT,e),this.stat=t}function Fo(e){const t=Po();oo(t,new xo(t,e))}function Uo(e,t){ps.call(this,Ro.Ua,e),this.size=t}function Vo(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return es.setTimeout((function(){e()}),t)}Ro.Ta="serverreachability",ls(Lo,ps),Ro.STAT_EVENT="statevent",ls(xo,ps),Ro.Ua="timingevent",ls(Uo,ps);var jo={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Bo={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function $o(){}function Ho(e){return e.h||(e.h=e.i())}function zo(){}$o.prototype.h=null;var Ko,qo={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Go(){ps.call(this,"d")}function Wo(){ps.call(this,"c")}function Qo(){}function Xo(e,t,n,i){this.l=e,this.j=t,this.m=n,this.W=i||1,this.U=new So(this),this.P=Yo,e=As?125:void 0,this.V=new Io(e),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Jo}function Jo(){this.i=null,this.g="",this.h=!1}ls(Go,ps),ls(Wo,ps),ls(Qo,$o),Qo.prototype.g=function(){return new XMLHttpRequest},Qo.prototype.i=function(){return{}},Ko=new Qo;var Yo=45e3,Zo={},ea={};function ta(e,t,n){e.L=1,e.v=Ia(ga(t)),e.s=n,e.S=!0,na(e,null)}function na(e,t){e.G=Date.now(),oa(e),e.A=ga(e.v);var n=e.A,i=e.W;Array.isArray(i)||(i=[String(i)]),Pa(n.i,"t",i),e.C=0,n=e.l.J,e.h=new Jo,e.g=Oc(e.l,n?t:null,!e.s),0<e.O&&(e.M=new _o(as(e.Pa,e,e.g),e.O)),Co(e.U,e.g,"readystatechange",e.nb),t=e.I?Bs(e.I):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.A,e.u,e.s,t)):(e.u="GET",e.g.ha(e.A,e.u,null,t)),Mo(),function(e,t,n,i,r,s){e.info((function(){if(e.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var h=u.split("_");o=2<=h.length&&"type"==h[1]?o+(u+"=")+l+"&":o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.W,e.s)}function ia(e){return!!e.g&&"GET"==e.u&&2!=e.L&&e.l.Ha}function ra(e,t,n){let i,r=!0;for(;!e.J&&e.C<n.length;){if(i=sa(e,n),i==ea){4==t&&(e.o=4,Fo(14),r=!1),Do(e.j,e.m,null,"[Incomplete Response]");break}if(i==Zo){e.o=4,Fo(15),Do(e.j,e.m,n,"[Invalid Chunk]"),r=!1;break}Do(e.j,e.m,i,null),ha(e,i)}ia(e)&&i!=ea&&i!=Zo&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,Fo(16),r=!1),e.i=e.i&&r,r?0<n.length&&!e.ba&&(e.ba=!0,(t=e.l).g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),_c(t),t.M=!0,Fo(11))):(Do(e.j,e.m,n,"[Invalid Chunked Response]"),ua(e),la(e))}function sa(e,t){var n=e.C,i=t.indexOf("\n",n);return-1==i?ea:(n=Number(t.substring(n,i)),isNaN(n)?Zo:(i+=1)+n>t.length?ea:(t=t.slice(i,i+n),e.C=i+n,t))}function oa(e){e.Y=Date.now()+e.P,aa(e,e.P)}function aa(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Vo(as(e.lb,e),t)}function ca(e){e.B&&(es.clearTimeout(e.B),e.B=null)}function la(e){0==e.l.H||e.J||Cc(e.l,e)}function ua(e){ca(e);var t=e.M;t&&"function"==typeof t.sa&&t.sa(),e.M=null,bo(e.V),ko(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function ha(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||Va(n.i,e)))if(!e.K&&Va(n.i,e)&&3==n.H){try{var i=n.Ja.g.parse(t)}catch(e){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<e.G))break e;Ac(n),mc(n)}Tc(n),Fo(18)}}else n.Fa=r[1],0<n.Fa-n.V&&37500>r[2]&&n.G&&0==n.A&&!n.v&&(n.v=Vo(as(n.ib,n),6e3));if(1>=Ua(n.i)&&n.oa){try{n.oa()}catch(e){}n.oa=void 0}}else Nc(n,11)}else if((e.K||n.g==e)&&Ac(n),!ms(t))for(r=n.Ja.g.parse(t),t=0;t<r.length;t++){let l=r[t];if(n.V=l[0],l=l[1],2==n.H)if("c"==l[0]){n.K=l[1],n.pa=l[2];const t=l[3];null!=t&&(n.ra=t,n.l.info("VER="+n.ra));const r=l[4];null!=r&&(n.Ga=r,n.l.info("SVER="+n.Ga));const u=l[5];null!=u&&"number"==typeof u&&0<u&&(i=1.5*u,n.L=i,n.l.info("backChannelRequestTimeoutMs_="+i)),i=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=i.i;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(ja(s,s.h),s.h=null))}if(i.F){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(i.Da=e,wa(i.I,i.F,e))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-e.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=e;if((i=n).wa=Rc(i,i.J?i.pa:null,i.Y),o.K){Ba(i.i,o);var a=o,c=i.L;c&&a.setTimeout(c),a.B&&(ca(a),oa(a)),i.g=o}else Ec(i);0<n.j.length&&vc(n)}else"stop"!=l[0]&&"close"!=l[0]||Nc(n,7);else 3==n.H&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?Nc(n,7):gc(n):"noop"!=l[0]&&n.h&&n.h.Aa(l),n.A=0)}Mo()}catch(e){}}function da(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(ts(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.ta&&"function"==typeof e.ta)return e.ta();if(!e.Z||"function"!=typeof e.Z){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(ts(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const i in e)t[n++]=i;return t}}}(e),i=function(e){if(e.Z&&"function"==typeof e.Z)return e.Z();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(ts(e)){for(var t=[],n=e.length,i=0;i<n;i++)t.push(e[i]);return t}for(i in t=[],n=0,e)t[n++]=e[i];return t}(e),r=i.length,s=0;s<r;s++)t.call(void 0,i[s],n&&n[s],e)}(Xr=Xo.prototype).setTimeout=function(e){this.P=e},Xr.nb=function(e){e=e.target;const t=this.M;t&&3==lc(e)?t.l():this.Pa(e)},Xr.Pa=function(e){try{if(e==this.g)e:{const u=lc(this.g);var t=this.g.Ia();if(this.g.da(),!(3>u)&&(3!=u||As||this.g&&(this.h.h||this.g.ja()||uc(this.g)))){this.J||4!=u||7==t||Mo(),ca(this);var n=this.g.da();this.ca=n;t:if(ia(this)){var i=uc(this.g);e="";var r=i.length,s=4==lc(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){ua(this),la(this);var o="";break t}this.h.i=new es.TextDecoder}for(t=0;t<r;t++)this.h.h=!0,e+=this.h.i.decode(i[t],{stream:s&&t==r-1});i.splice(0,r),this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function(e,t,n,i,r,s,o){e.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+t+"\n"+n+"\n"+s+" "+o}))}(this.j,this.u,this.A,this.m,this.W,u,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ms(a)){var l=a;break t}}l=null}if(!(n=l)){this.i=!1,this.o=3,Fo(12),ua(this),la(this);break e}Do(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ha(this,n)}this.S?(ra(this,u,o),As&&this.i&&3==u&&(Co(this.U,this.V,"tick",this.mb),this.V.start())):(Do(this.j,this.m,o,null),ha(this,o)),4==u&&ua(this),this.i&&!this.J&&(4==u?Cc(this.l,this):(this.i=!1,oa(this)))}else(function(e){const t={};e=(e.g&&2<=lc(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<e.length;i++){if(ms(e[i]))continue;var n=fo(e[i]);const r=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const s=t[r]||[];t[r]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.o=3,Fo(12)):(this.o=0,Fo(13)),ua(this),la(this)}}}catch(e){}},Xr.mb=function(){if(this.g){var e=lc(this.g),t=this.g.ja();this.C<t.length&&(ca(this),ra(this,e,t),this.i&&4!=e&&oa(this))}},Xr.cancel=function(){this.J=!0,ua(this)},Xr.lb=function(){this.B=null;const e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.L&&(Mo(),Fo(17)),ua(this),this.o=2,la(this)):aa(this,this.Y-e)};var fa=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function pa(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof pa){this.h=e.h,ma(this,e.j),this.s=e.s,this.g=e.g,ya(this,e.m),this.l=e.l;var t=e.i,n=new Na;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),va(this,n),this.o=e.o}else e&&(t=String(e).match(fa))?(this.h=!1,ma(this,t[1]||"",!0),this.s=ba(t[2]||""),this.g=ba(t[3]||"",!0),ya(this,t[4]),this.l=ba(t[5]||"",!0),va(this,t[6]||"",!0),this.o=ba(t[7]||"")):(this.h=!1,this.i=new Na(null,this.h))}function ga(e){return new pa(e)}function ma(e,t,n){e.j=n?ba(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function ya(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function va(e,t,n){t instanceof Na?(e.i=t,function(e,t){t&&!e.j&&(Da(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Ra(this,t),Pa(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=Ea(t,Ca)),e.i=new Na(t,e.h))}function wa(e,t,n){e.i.set(t,n)}function Ia(e){return wa(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function ba(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Ea(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,Ta),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Ta(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}pa.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Ea(t,_a,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(Ea(t,_a,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(Ea(n,"/"==n.charAt(0)?Aa:Sa,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Ea(n,ka)),e.join("")};var _a=/[#\/\?@]/g,Sa=/[#\?:]/g,Aa=/[#\?]/g,Ca=/[#\?@]/g,ka=/#/g;function Na(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Da(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var i=e[n].indexOf("="),r=null;if(0<=i){var s=e[n].substring(0,i);r=e[n].substring(i+1)}else s=e[n];t(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Ra(e,t){Da(e),t=La(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Oa(e,t){return Da(e),t=La(e,t),e.g.has(t)}function Pa(e,t,n){Ra(e,t),0<n.length&&(e.i=null,e.g.set(La(e,t),ds(n)),e.h+=n.length)}function La(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Ma(e){this.l=e||xa,e=es.PerformanceNavigationTiming?0<(e=es.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(es.g&&es.g.Ka&&es.g.Ka()&&es.g.Ka().ec),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(Xr=Na.prototype).add=function(e,t){Da(this),this.i=null,e=La(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},Xr.forEach=function(e,t){Da(this),this.g.forEach((function(n,i){n.forEach((function(n){e.call(t,n,i,this)}),this)}),this)},Xr.ta=function(){Da(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let i=0;i<t.length;i++){const r=e[i];for(let e=0;e<r.length;e++)n.push(t[i])}return n},Xr.Z=function(e){Da(this);let t=[];if("string"==typeof e)Oa(this,e)&&(t=t.concat(this.g.get(La(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},Xr.set=function(e,t){return Da(this),this.i=null,Oa(this,e=La(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},Xr.get=function(e,t){return e&&0<(e=this.Z(e)).length?String(e[0]):t},Xr.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var i=t[n];const s=encodeURIComponent(String(i)),o=this.Z(i);for(i=0;i<o.length;i++){var r=s;""!==o[i]&&(r+="="+encodeURIComponent(String(o[i]))),e.push(r)}}return this.i=e.join("&")};var xa=10;function Fa(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Ua(e){return e.h?1:e.g?e.g.size:0}function Va(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function ja(e,t){e.g?e.g.add(t):e.h=t}function Ba(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function $a(e){if(null!=e.h)return e.i.concat(e.h.F);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.F);return t}return ds(e.i)}Ma.prototype.cancel=function(){if(this.i=$a(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var Ha=class{stringify(e){return es.JSON.stringify(e,void 0)}parse(e){return es.JSON.parse(e,void 0)}};function za(){this.g=new Ha}function Ka(e,t,n){const i=n||"";try{da(e,(function(e,n){let r=e;ns(e)&&(r=co(e)),t.push(i+n+"="+encodeURIComponent(r))}))}catch(e){throw t.push(i+"type="+encodeURIComponent("_badmap")),e}}function qa(e,t,n,i,r){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,r(i)}catch(e){}}function Ga(e){this.l=e.fc||null,this.j=e.ob||!1}function Wa(e,t){so.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=Qa,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ls(Ga,$o),Ga.prototype.g=function(){return new Wa(this.l,this.j)},Ga.prototype.i=function(e){return function(){return e}}({}),ls(Wa,so);var Qa=0;function Xa(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}function Ja(e){e.readyState=4,e.l=null,e.j=null,e.A=null,Ya(e)}function Ya(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(Xr=Wa.prototype).open=function(e,t){if(this.readyState!=Qa)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,Ya(this)},Xr.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||es).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))},Xr.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Ja(this)),this.readyState=Qa},Xr.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Ya(this)),this.g&&(this.readyState=3,Ya(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==es.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Xa(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))},Xr.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Ja(this):Ya(this),3==this.readyState&&Xa(this)}},Xr.Za=function(e){this.g&&(this.response=this.responseText=e,Ja(this))},Xr.Ya=function(e){this.g&&(this.response=e,Ja(this))},Xr.ka=function(){this.g&&Ja(this)},Xr.setRequestHeader=function(e,t){this.v.append(e,t)},Xr.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},Xr.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Wa.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var Za=es.JSON.parse;function ec(e){so.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=tc,this.L=this.M=!1}ls(ec,so);var tc="",nc=/^https?$/i,ic=["POST","PUT"];function rc(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,sc(e),ac(e)}function sc(e){e.F||(e.F=!0,oo(e,"complete"),oo(e,"error"))}function oc(e){if(e.h&&void 0!==Zr&&(!e.C[1]||4!=lc(e)||2!=e.da()))if(e.v&&4==lc(e))Eo(e.La,0,e);else if(oo(e,"readystatechange"),4==lc(e)){e.h=!1;try{const o=e.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var i;if(i=0===o){var r=String(e.I).match(fa)[1]||null;!r&&es.self&&es.self.location&&(r=es.self.location.protocol.slice(0,-1)),i=!nc.test(r?r.toLowerCase():"")}n=i}if(n)oo(e,"complete"),oo(e,"success");else{e.m=6;try{var s=2<lc(e)?e.g.statusText:""}catch(e){s=""}e.j=s+" ["+e.da()+"]",sc(e)}}finally{ac(e)}}}function ac(e,t){if(e.g){cc(e);const n=e.g,i=e.C[0]?()=>{}:null;e.g=null,e.C=null,t||oo(e,"ready");try{n.onreadystatechange=i}catch(e){}}}function cc(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(es.clearTimeout(e.A),e.A=null)}function lc(e){return e.g?e.g.readyState:0}function uc(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case tc:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function hc(e){let t="";return js(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function dc(e,t,n){e:{for(i in n){var i=!1;break e}i=!0}i||(n=hc(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):wa(e,t,n))}function fc(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function pc(e){this.Ga=0,this.j=[],this.l=new No,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=fc("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=fc("baseRetryDelayMs",5e3,e),this.hb=fc("retryDelaySeedMs",1e4,e),this.eb=fc("forwardChannelMaxRetries",2,e),this.xa=fc("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.dc||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new Ma(e&&e.concurrentRequestLimit),this.Ja=new za,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function gc(e){if(yc(e),3==e.H){var t=e.W++,n=ga(e.I);if(wa(n,"SID",e.K),wa(n,"RID",t),wa(n,"TYPE","terminate"),Ic(e,n),(t=new Xo(e,e.l,t)).L=2,t.v=Ia(ga(n)),n=!1,es.navigator&&es.navigator.sendBeacon)try{n=es.navigator.sendBeacon(t.v.toString(),"")}catch(e){}!n&&es.Image&&((new Image).src=t.v,n=!0),n||(t.g=Oc(t.l,null),t.g.ha(t.v)),t.G=Date.now(),oa(t)}Dc(e)}function mc(e){e.g&&(_c(e),e.g.cancel(),e.g=null)}function yc(e){mc(e),e.u&&(es.clearTimeout(e.u),e.u=null),Ac(e),e.i.cancel(),e.m&&("number"==typeof e.m&&es.clearTimeout(e.m),e.m=null)}function vc(e){if(!Fa(e.i)&&!e.m){e.m=!0;var t=e.Na;go||vo(),mo||(go(),mo=!0),yo.add(t,e),e.C=0}}function wc(e,t){var n;n=t?t.m:e.W++;const i=ga(e.I);wa(i,"SID",e.K),wa(i,"RID",n),wa(i,"AID",e.V),Ic(e,i),e.o&&e.s&&dc(i,e.o,e.s),n=new Xo(e,e.l,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.j=t.F.concat(e.j)),t=bc(e,n,1e3),n.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),ja(e.i,n),ta(n,i,t)}function Ic(e,t){e.na&&js(e.na,(function(e,n){wa(t,n,e)})),e.h&&da({},(function(e,n){wa(t,n,e)}))}function bc(e,t,n){n=Math.min(e.j.length,n);var i=e.h?as(e.h.Va,e.h,e):null;e:{var r=e.j;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=r[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<n;o++){let n=r[o].g;const a=r[o].map;if(n-=t,0>n)t=Math.max(0,r[o].g-100),s=!1;else try{Ka(a,e,"req"+n+"_")}catch(e){i&&i(a)}}if(s){i=e.join("&");break e}}}return e=e.j.splice(0,n),t.F=e,i}function Ec(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;go||vo(),mo||(go(),mo=!0),yo.add(t,e),e.A=0}}function Tc(e){return!(e.g||e.u||3<=e.A||(e.ba++,e.u=Vo(as(e.Ma,e),kc(e,e.A)),e.A++,0))}function _c(e){null!=e.B&&(es.clearTimeout(e.B),e.B=null)}function Sc(e){e.g=new Xo(e,e.l,"rpc",e.ba),null===e.o&&(e.g.I=e.s),e.g.O=0;var t=ga(e.wa);wa(t,"RID","rpc"),wa(t,"SID",e.K),wa(t,"AID",e.V),wa(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&wa(t,"TO",e.qa),wa(t,"TYPE","xmlhttp"),Ic(e,t),e.o&&e.s&&dc(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var n=e.g;e=e.pa,n.L=1,n.v=Ia(ga(t)),n.s=null,n.S=!0,na(n,e)}function Ac(e){null!=e.v&&(es.clearTimeout(e.v),e.v=null)}function Cc(e,t){var n=null;if(e.g==t){Ac(e),_c(e),e.g=null;var i=2}else{if(!Va(e.i,t))return;n=t.F,Ba(e.i,t),i=1}if(0!=e.H)if(t.i)if(1==i){n=t.s?t.s.length:0,t=Date.now()-t.G;var r=e.C;oo(i=Po(),new Uo(i,n)),vc(e)}else Ec(e);else if(3==(r=t.o)||0==r&&0<t.ca||!(1==i&&function(e,t){return!(Ua(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.j=t.F.concat(e.j),0):1==e.H||2==e.H||e.C>=(e.cb?0:e.eb)||(e.m=Vo(as(e.Na,e,t),kc(e,e.C)),e.C++,0)))}(e,t)||2==i&&Tc(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),r){case 1:Nc(e,5);break;case 4:Nc(e,10);break;case 3:Nc(e,6);break;default:Nc(e,2)}}function kc(e,t){let n=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(n*=2),n*t}function Nc(e,t){if(e.l.info("Error code "+t),2==t){var n=null;e.h&&(n=null);var i=as(e.pb,e);n||(n=new pa("//www.google.com/images/cleardot.gif"),es.location&&"http"==es.location.protocol||ma(n,"https"),Ia(n)),function(e,t){const n=new No;if(es.Image){const i=new Image;i.onload=cs(qa,n,i,"TestLoadImage: loaded",!0,t),i.onerror=cs(qa,n,i,"TestLoadImage: error",!1,t),i.onabort=cs(qa,n,i,"TestLoadImage: abort",!1,t),i.ontimeout=cs(qa,n,i,"TestLoadImage: timeout",!1,t),es.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=e}else t(!1)}(n.toString(),i)}else Fo(2);e.H=0,e.h&&e.h.za(t),Dc(e),yc(e)}function Dc(e){if(e.H=0,e.ma=[],e.h){const t=$a(e.i);0==t.length&&0==e.j.length||(fs(e.ma,t),fs(e.ma,e.j),e.i.i.length=0,ds(e.j),e.j.length=0),e.h.ya()}}function Rc(e,t,n){var i=n instanceof pa?ga(n):new pa(n);if(""!=i.g)t&&(i.g=t+"."+i.g),ya(i,i.m);else{var r=es.location;i=r.protocol,t=t?t+"."+r.hostname:r.hostname,r=+r.port;var s=new pa(null);i&&ma(s,i),t&&(s.g=t),r&&ya(s,r),n&&(s.l=n),i=s}return n=e.F,t=e.Da,n&&t&&wa(i,n,t),wa(i,"VER",e.ra),Ic(e,i),i}function Oc(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ha&&!e.va?new ec(new Ga({ob:!0})):new ec(e.va)).Oa(e.J),t}function Pc(){}function Lc(){if(_s&&!(10<=Number(Ps)))throw Error("Environmental error: no available transport.")}function Mc(e,t){so.call(this),this.g=new pc(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!ms(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!ms(t)&&(this.g.F=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new Uc(this)}function xc(e){Go.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function Fc(){Wo.call(this),this.status=1}function Uc(e){this.g=e}function Vc(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function jc(e,t,n){n||(n=0);var i=Array(16);if("string"==typeof t)for(var r=0;16>r;++r)i[r]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(r=0;16>r;++r)i[r]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],r=e.g[2];var s=e.g[3],o=t+(s^n&(r^s))+i[0]+3614090360&4294967295;o=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=n+(o<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(r^s))+i[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(r^s))+i[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(r^s))+i[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(r^s&(n^r))+i[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^s&(n^r))+i[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^s&(n^r))+i[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^s&(n^r))+i[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^r^s)+i[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^r^s)+i[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^r^s)+i[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^r^s)+i[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(r^(n|~s))+i[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=r+(t^(s|~n))+i[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~t))+i[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(r^(n|~s))+i[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=r+(t^(s|~n))+i[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~t))+i[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(r^(n|~s))+i[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=r+(t^(s|~n))+i[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~t))+i[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(t=n+((o=t+(r^(n|~s))+i[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((r=s+((o=r+(t^(s|~n))+i[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+i[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(r+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+r&4294967295,e.g[3]=e.g[3]+s&4294967295}function Bc(e,t){this.h=t;for(var n=[],i=!0,r=e.length-1;0<=r;r--){var s=0|e[r];i&&s==t||(n[r]=s,i=!1)}this.g=n}(Xr=ec.prototype).Oa=function(e){this.M=e},Xr.ha=function(e,t,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Ko.g(),this.C=this.u?Ho(this.u):Ho(Ko),this.g.onreadystatechange=as(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(e){return void rc(this,e)}if(e=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)n.set(r,i[r]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const e of i.keys())n.set(e,i.get(e))}i=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),r=es.FormData&&e instanceof es.FormData,!(0<=hs(ic,t))||i||r||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[e,t]of n)this.g.setRequestHeader(e,t);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{cc(this),0<this.B&&((this.L=function(e){return _s&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=as(this.ua,this)):this.A=Eo(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(e){rc(this,e)}},Xr.ua=function(){void 0!==Zr&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,oo(this,"timeout"),this.abort(8))},Xr.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,oo(this,"complete"),oo(this,"abort"),ac(this))},Xr.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),ac(this,!0)),ec.$.N.call(this)},Xr.La=function(){this.s||(this.G||this.v||this.l?oc(this):this.kb())},Xr.kb=function(){oc(this)},Xr.isActive=function(){return!!this.g},Xr.da=function(){try{return 2<lc(this)?this.g.status:-1}catch(e){return-1}},Xr.ja=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},Xr.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Za(t)}},Xr.Ia=function(){return this.m},Xr.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(Xr=pc.prototype).ra=8,Xr.H=1,Xr.Na=function(e){if(this.m)if(this.m=null,1==this.H){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;const r=new Xo(this,this.l,e);let s=this.s;if(this.U&&(s?(s=Bs(s),Hs(s,this.U)):s=this.U),null!==this.o||this.O||(r.I=s,s=null),this.P)e:{for(var t=0,n=0;n<this.j.length;n++){var i=this.j[n];if(void 0===(i="__data__"in i.map&&"string"==typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(t+=i)){t=n;break e}if(4096===t||n===this.j.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=bc(this,r,t),wa(n=ga(this.I),"RID",e),wa(n,"CVER",22),this.F&&wa(n,"X-HTTP-Session-Id",this.F),Ic(this,n),s&&(this.O?t="headers="+encodeURIComponent(String(hc(s)))+"&"+t:this.o&&dc(n,this.o,s)),ja(this.i,r),this.bb&&wa(n,"TYPE","init"),this.P?(wa(n,"$req",t),wa(n,"SID","null"),r.aa=!0,ta(r,n,null)):ta(r,n,t),this.H=2}}else 3==this.H&&(e?wc(this,e):0==this.j.length||Fa(this.i)||wc(this))},Xr.Ma=function(){if(this.u=null,Sc(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=Vo(as(this.jb,this),e)}},Xr.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Fo(10),mc(this),Sc(this))},Xr.ib=function(){null!=this.v&&(this.v=null,mc(this),Tc(this),Fo(19))},Xr.pb=function(e){e?(this.l.info("Successfully pinged google.com"),Fo(2)):(this.l.info("Failed to ping google.com"),Fo(1))},Xr.isActive=function(){return!!this.h&&this.h.isActive(this)},(Xr=Pc.prototype).Ba=function(){},Xr.Aa=function(){},Xr.za=function(){},Xr.ya=function(){},Xr.isActive=function(){return!0},Xr.Va=function(){},Lc.prototype.g=function(e,t){return new Mc(e,t)},ls(Mc,so),Mc.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;Fo(0),e.Y=t,e.na=n||{},e.G=e.aa,e.I=Rc(e,null,e.Y),vc(e)},Mc.prototype.close=function(){gc(this.g)},Mc.prototype.u=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=co(e),e=n);t.j.push(new class{constructor(e,t){this.g=e,this.map=t}}(t.fb++,e)),3==t.H&&vc(t)},Mc.prototype.N=function(){this.g.h=null,delete this.j,gc(this.g),delete this.g,Mc.$.N.call(this)},ls(xc,Go),ls(Fc,Wo),ls(Uc,Pc),Uc.prototype.Ba=function(){oo(this.g,"a")},Uc.prototype.Aa=function(e){oo(this.g,new xc(e))},Uc.prototype.za=function(e){oo(this.g,new Fc)},Uc.prototype.ya=function(){oo(this.g,"b")},ls(Vc,(function(){this.blockSize=-1})),Vc.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Vc.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,i=this.m,r=this.h,s=0;s<t;){if(0==r)for(;s<=n;)jc(this,e,s),s+=this.blockSize;if("string"==typeof e){for(;s<t;)if(i[r++]=e.charCodeAt(s++),r==this.blockSize){jc(this,i),r=0;break}}else for(;s<t;)if(i[r++]=e[s++],r==this.blockSize){jc(this,i),r=0;break}}this.h=r,this.i+=t},Vc.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var i=0;32>i;i+=8)e[n++]=this.g[t]>>>i&255;return e};var $c={};function Hc(e){return-128<=e&&128>e?function(e,t){var n=$c;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=function(e){return new Bc([0|e],0>e?-1:0)}(e)}(e):new Bc([0|e],0>e?-1:0)}function zc(e){if(isNaN(e)||!isFinite(e))return qc;if(0>e)return Jc(zc(-e));for(var t=[],n=1,i=0;e>=n;i++)t[i]=e/n|0,n*=Kc;return new Bc(t,0)}var Kc=4294967296,qc=Hc(0),Gc=Hc(1),Wc=Hc(16777216);function Qc(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function Xc(e){return-1==e.h}function Jc(e){for(var t=e.g.length,n=[],i=0;i<t;i++)n[i]=~e.g[i];return new Bc(n,~e.h).add(Gc)}function Yc(e,t){return e.add(Jc(t))}function Zc(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function el(e,t){this.g=e,this.h=t}function tl(e,t){if(Qc(t))throw Error("division by zero");if(Qc(e))return new el(qc,qc);if(Xc(e))return t=tl(Jc(e),t),new el(Jc(t.g),Jc(t.h));if(Xc(t))return t=tl(e,Jc(t)),new el(Jc(t.g),t.h);if(30<e.g.length){if(Xc(e)||Xc(t))throw Error("slowDivide_ only works with positive integers.");for(var n=Gc,i=t;0>=i.X(e);)n=nl(n),i=nl(i);var r=il(n,1),s=il(i,1);for(i=il(i,2),n=il(n,2);!Qc(i);){var o=s.add(i);0>=o.X(e)&&(r=r.add(n),s=o),i=il(i,1),n=il(n,1)}return t=Yc(e,r.R(t)),new el(r,t)}for(r=qc;0<=e.X(t);){for(n=Math.max(1,Math.floor(e.ea()/t.ea())),i=48>=(i=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,i-48),o=(s=zc(n)).R(t);Xc(o)||0<o.X(e);)o=(s=zc(n-=i)).R(t);Qc(s)&&(s=Gc),r=r.add(s),e=Yc(e,o)}return new el(r,e)}function nl(e){for(var t=e.g.length+1,n=[],i=0;i<t;i++)n[i]=e.D(i)<<1|e.D(i-1)>>>31;return new Bc(n,e.h)}function il(e,t){var n=t>>5;t%=32;for(var i=e.g.length-n,r=[],s=0;s<i;s++)r[s]=0<t?e.D(s+n)>>>t|e.D(s+n+1)<<32-t:e.D(s+n);return new Bc(r,e.h)}(Xr=Bc.prototype).ea=function(){if(Xc(this))return-Jc(this).ea();for(var e=0,t=1,n=0;n<this.g.length;n++){var i=this.D(n);e+=(0<=i?i:Kc+i)*t,t*=Kc}return e},Xr.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(Qc(this))return"0";if(Xc(this))return"-"+Jc(this).toString(e);for(var t=zc(Math.pow(e,6)),n=this,i="";;){var r=tl(n,t).g,s=((0<(n=Yc(n,r.R(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(Qc(n=r))return s+i;for(;6>s.length;)s="0"+s;i=s+i}},Xr.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},Xr.X=function(e){return Xc(e=Yc(this,e))?-1:Qc(e)?0:1},Xr.abs=function(){return Xc(this)?Jc(this):this},Xr.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0,r=0;r<=t;r++){var s=i+(65535&this.D(r))+(65535&e.D(r)),o=(s>>>16)+(this.D(r)>>>16)+(e.D(r)>>>16);i=o>>>16,s&=65535,o&=65535,n[r]=o<<16|s}return new Bc(n,-2147483648&n[n.length-1]?-1:0)},Xr.R=function(e){if(Qc(this)||Qc(e))return qc;if(Xc(this))return Xc(e)?Jc(this).R(Jc(e)):Jc(Jc(this).R(e));if(Xc(e))return Jc(this.R(Jc(e)));if(0>this.X(Wc)&&0>e.X(Wc))return zc(this.ea()*e.ea());for(var t=this.g.length+e.g.length,n=[],i=0;i<2*t;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var r=0;r<e.g.length;r++){var s=this.D(i)>>>16,o=65535&this.D(i),a=e.D(r)>>>16,c=65535&e.D(r);n[2*i+2*r]+=o*c,Zc(n,2*i+2*r),n[2*i+2*r+1]+=s*c,Zc(n,2*i+2*r+1),n[2*i+2*r+1]+=o*a,Zc(n,2*i+2*r+1),n[2*i+2*r+2]+=s*a,Zc(n,2*i+2*r+2)}for(i=0;i<t;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=t;i<2*t;i++)n[i]=0;return new Bc(n,0)},Xr.gb=function(e){return tl(this,e).h},Xr.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.D(i)&e.D(i);return new Bc(n,this.h&e.h)},Xr.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.D(i)|e.D(i);return new Bc(n,this.h|e.h)},Xr.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.D(i)^e.D(i);return new Bc(n,this.h^e.h)},Lc.prototype.createWebChannel=Lc.prototype.g,Mc.prototype.send=Mc.prototype.u,Mc.prototype.open=Mc.prototype.m,Mc.prototype.close=Mc.prototype.close,jo.NO_ERROR=0,jo.TIMEOUT=8,jo.HTTP_ERROR=6,Bo.COMPLETE="complete",zo.EventType=qo,qo.OPEN="a",qo.CLOSE="b",qo.ERROR="c",qo.MESSAGE="d",so.prototype.listen=so.prototype.O,ec.prototype.listenOnce=ec.prototype.P,ec.prototype.getLastError=ec.prototype.Sa,ec.prototype.getLastErrorCode=ec.prototype.Ia,ec.prototype.getStatus=ec.prototype.da,ec.prototype.getResponseJson=ec.prototype.Wa,ec.prototype.getResponseText=ec.prototype.ja,ec.prototype.send=ec.prototype.ha,ec.prototype.setWithCredentials=ec.prototype.Oa,Vc.prototype.digest=Vc.prototype.l,Vc.prototype.reset=Vc.prototype.reset,Vc.prototype.update=Vc.prototype.j,Bc.prototype.add=Bc.prototype.add,Bc.prototype.multiply=Bc.prototype.R,Bc.prototype.modulo=Bc.prototype.gb,Bc.prototype.compare=Bc.prototype.X,Bc.prototype.toNumber=Bc.prototype.ea,Bc.prototype.toString=Bc.prototype.toString,Bc.prototype.getBits=Bc.prototype.D,Bc.fromNumber=zc,Bc.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return Jc(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=zc(Math.pow(n,8)),r=qc,s=0;s<t.length;s+=8){var o=Math.min(8,t.length-s),a=parseInt(t.substring(s,s+o),n);8>o?(o=zc(Math.pow(n,o)),r=r.R(o).add(zc(a))):r=(r=r.R(i)).add(zc(a))}return r};var rl=Yr.createWebChannelTransport=function(){return new Lc},sl=Yr.getStatEventTarget=function(){return Po()},ol=Yr.ErrorCode=jo,al=Yr.EventType=Bo,cl=Yr.Event=Ro,ll=Yr.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},ul=Yr.FetchXmlHttpFactory=Ga,hl=Yr.WebChannel=zo,dl=Yr.XhrIo=ec,fl=(Yr.Md5=Vc,Yr.Integer=Bc);const pl="@firebase/firestore";class gl{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}gl.UNAUTHENTICATED=new gl(null),gl.GOOGLE_CREDENTIALS=new gl("google-credentials-uid"),gl.FIRST_PARTY=new gl("first-party-uid"),gl.MOCK_USER=new gl("mock-user");let ml="9.23.0";const yl=new $("@firebase/firestore");function vl(){return yl.logLevel}function wl(e,...t){if(yl.logLevel<=x.DEBUG){const n=t.map(El);yl.debug(`Firestore (${ml}): ${e}`,...n)}}function Il(e,...t){if(yl.logLevel<=x.ERROR){const n=t.map(El);yl.error(`Firestore (${ml}): ${e}`,...n)}}function bl(e,...t){if(yl.logLevel<=x.WARN){const n=t.map(El);yl.warn(`Firestore (${ml}): ${e}`,...n)}}function El(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}function Tl(e="Unexpected state"){const t=`FIRESTORE (${ml}) INTERNAL ASSERTION FAILED: `+e;throw Il(t),new Error(t)}function _l(e,t){e||Tl()}function Sl(e,t){return e}const Al={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Cl extends g{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class kl{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Nl{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Dl{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(gl.UNAUTHENTICATED)))}shutdown(){}}class Rl{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Ol{constructor(e){this.t=e,this.currentUser=gl.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const i=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let r=new kl;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new kl,e.enqueueRetryable((()=>i(this.currentUser)))};const s=()=>{const t=r;e.enqueueRetryable((async()=>{await t.promise,await i(this.currentUser)}))},o=e=>{wl("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(wl("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new kl)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(wl("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(_l("string"==typeof t.accessToken),new Nl(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return _l(null===e||"string"==typeof e),new gl(e)}}class Pl{constructor(e,t,n){this.h=e,this.l=t,this.m=n,this.type="FirstParty",this.user=gl.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class Ll{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new Pl(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable((()=>t(gl.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Ml{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class xl{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){const n=e=>{null!=e.error&&wl("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.T;return this.T=e.token,wl("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const i=e=>{wl("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.I.onInit((e=>i(e))),setTimeout((()=>{if(!this.appCheck){const e=this.I.getImmediate({optional:!0});e?i(e):wl("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(_l("string"==typeof e.token),this.T=e.token,new Ml(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Fl(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}class Ul{static A(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=Fl(40);for(let i=0;i<n.length;++i)t.length<20&&n[i]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[i]%62))}return t}}function Vl(e,t){return e<t?-1:e>t?1:0}function jl(e,t,n){return e.length===t.length&&e.every(((e,i)=>n(e,t[i])))}class Bl{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Cl(Al.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Cl(Al.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Cl(Al.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Cl(Al.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Bl.fromMillis(Date.now())}static fromDate(e){return Bl.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new Bl(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Vl(this.nanoseconds,e.nanoseconds):Vl(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class $l{constructor(e){this.timestamp=e}static fromTimestamp(e){return new $l(e)}static min(){return new $l(new Bl(0,0))}static max(){return new $l(new Bl(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Hl{constructor(e,t,n){void 0===t?t=0:t>e.length&&Tl(),void 0===n?n=e.length-t:n>e.length-t&&Tl(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Hl.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Hl?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const n=e.get(i),r=t.get(i);if(n<r)return-1;if(n>r)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class zl extends Hl{construct(e,t,n){return new zl(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Cl(Al.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new zl(t)}static emptyPath(){return new zl([])}}const Kl=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ql extends Hl{construct(e,t,n){return new ql(e,t,n)}static isValidIdentifier(e){return Kl.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ql.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new ql(["__name__"])}static fromServerFormat(e){const t=[];let n="",i=0;const r=()=>{if(0===n.length)throw new Cl(Al.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;i<e.length;){const t=e[i];if("\\"===t){if(i+1===e.length)throw new Cl(Al.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[i+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Cl(Al.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,i+=2}else"`"===t?(s=!s,i++):"."!==t||s?(n+=t,i++):(r(),i++)}if(r(),s)throw new Cl(Al.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ql(t)}static emptyPath(){return new ql([])}}class Gl{constructor(e){this.path=e}static fromPath(e){return new Gl(zl.fromString(e))}static fromName(e){return new Gl(zl.fromString(e).popFirst(5))}static empty(){return new Gl(zl.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===zl.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return zl.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Gl(new zl(e.slice()))}}function Wl(e){return new Ql(e.readTime,e.key,-1)}class Ql{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Ql($l.min(),Gl.empty(),-1)}static max(){return new Ql($l.max(),Gl.empty(),-1)}}function Xl(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=Gl.comparator(e.documentKey,t.documentKey),0!==n?n:Vl(e.largestBatchId,t.largestBatchId))}const Jl="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Yl{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Zl(e){if(e.code!==Al.FAILED_PRECONDITION||e.message!==Jl)throw e;wl("LocalStore","Unexpectedly lost primary lease")}class eu{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Tl(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new eu(((n,i)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,i)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof eu?t:eu.resolve(t)}catch(e){return eu.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):eu.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):eu.reject(t)}static resolve(e){return new eu(((t,n)=>{t(e)}))}static reject(e){return new eu(((t,n)=>{n(e)}))}static waitFor(e){return new eu(((t,n)=>{let i=0,r=0,s=!1;e.forEach((e=>{++i,e.next((()=>{++r,s&&r===i&&t()}),(e=>n(e)))})),s=!0,r===i&&t()}))}static or(e){let t=eu.resolve(!1);for(const n of e)t=t.next((e=>e?eu.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,i)=>{n.push(t.call(this,e,i))})),this.waitFor(n)}static mapArray(e,t){return new eu(((n,i)=>{const r=e.length,s=new Array(r);let o=0;for(let a=0;a<r;a++){const c=a;t(e[c]).next((e=>{s[c]=e,++o,o===r&&n(s)}),(e=>i(e)))}}))}static doWhile(e,t){return new eu(((n,i)=>{const r=()=>{!0===e()?t().next((()=>{r()}),i):n()};r()}))}}function tu(e){return"IndexedDbTransactionError"===e.name}class nu{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ot(e),this.ut=e=>t.writeSequenceNumber(e))}ot(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ut&&this.ut(e),e}}function iu(e){return null==e}function ru(e){return 0===e&&1/e==-1/0}nu.ct=-1;function su(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function ou(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function au(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class cu{constructor(e,t){this.comparator=e,this.root=t||uu.EMPTY}insert(e,t){return new cu(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,uu.BLACK,null,null))}remove(e){return new cu(this.comparator,this.root.remove(e,this.comparator).copy(null,null,uu.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(0===i)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new lu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new lu(this.root,e,this.comparator,!1)}getReverseIterator(){return new lu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new lu(this.root,e,this.comparator,!0)}}class lu{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=t?n(e.key,t):1,t&&i&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(0===r){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class uu{constructor(e,t,n,i,r){this.key=e,this.value=t,this.color=null!=n?n:uu.RED,this.left=null!=i?i:uu.EMPTY,this.right=null!=r?r:uu.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,r){return new uu(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const r=n(e,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===r?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return uu.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return uu.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,uu.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,uu.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Tl();if(this.right.isRed())throw Tl();const e=this.left.check();if(e!==this.right.check())throw Tl();return e+(this.isRed()?0:1)}}uu.EMPTY=null,uu.RED=!0,uu.BLACK=!1,uu.EMPTY=new class{constructor(){this.size=0}get key(){throw Tl()}get value(){throw Tl()}get color(){throw Tl()}get left(){throw Tl()}get right(){throw Tl()}copy(e,t,n,i,r){return this}insert(e,t,n){return new uu(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class hu{constructor(e){this.comparator=e,this.data=new cu(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new du(this.data.getIterator())}getIteratorFrom(e){return new du(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof hu))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,i=n.getNext().key;if(0!==this.comparator(e,i))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new hu(this.comparator);return t.data=e,t}}class du{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class fu{constructor(e){this.fields=e,e.sort(ql.comparator)}static empty(){return new fu([])}unionWith(e){let t=new hu(ql.comparator);for(const e of this.fields)t=t.add(e);for(const n of e)t=t.add(n);return new fu(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return jl(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class pu extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class gu{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new pu("Invalid base64 string: "+e):e}}(e);return new gu(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new gu(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Vl(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}gu.EMPTY_BYTE_STRING=new gu("");const mu=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yu(e){if(_l(!!e),"string"==typeof e){let t=0;const n=mu.exec(e);if(_l(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:vu(e.seconds),nanos:vu(e.nanos)}}function vu(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function wu(e){return"string"==typeof e?gu.fromBase64String(e):gu.fromUint8Array(e)}function Iu(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function bu(e){const t=e.mapValue.fields.__previous_value__;return Iu(t)?bu(t):t}function Eu(e){const t=yu(e.mapValue.fields.__local_write_time__.timestampValue);return new Bl(t.seconds,t.nanos)}class Tu{constructor(e,t,n,i,r,s,o,a,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=c}}class _u{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new _u("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof _u&&e.projectId===this.projectId&&e.database===this.database}}const Su={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Au(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Iu(e)?4:Fu(e)?9007199254740991:10:Tl()}function Cu(e,t){if(e===t)return!0;const n=Au(e);if(n!==Au(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Eu(e).isEqual(Eu(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=yu(e.timestampValue),i=yu(t.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return wu(e.bytesValue).isEqual(wu(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return vu(e.geoPointValue.latitude)===vu(t.geoPointValue.latitude)&&vu(e.geoPointValue.longitude)===vu(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return vu(e.integerValue)===vu(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=vu(e.doubleValue),i=vu(t.doubleValue);return n===i?ru(n)===ru(i):isNaN(n)&&isNaN(i)}return!1}(e,t);case 9:return jl(e.arrayValue.values||[],t.arrayValue.values||[],Cu);case 10:return function(e,t){const n=e.mapValue.fields||{},i=t.mapValue.fields||{};if(su(n)!==su(i))return!1;for(const e in n)if(n.hasOwnProperty(e)&&(void 0===i[e]||!Cu(n[e],i[e])))return!1;return!0}(e,t);default:return Tl()}}function ku(e,t){return void 0!==(e.values||[]).find((e=>Cu(e,t)))}function Nu(e,t){if(e===t)return 0;const n=Au(e),i=Au(t);if(n!==i)return Vl(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return Vl(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=vu(e.integerValue||e.doubleValue),i=vu(t.integerValue||t.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(e,t);case 3:return Du(e.timestampValue,t.timestampValue);case 4:return Du(Eu(e),Eu(t));case 5:return Vl(e.stringValue,t.stringValue);case 6:return function(e,t){const n=wu(e),i=wu(t);return n.compareTo(i)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),i=t.split("/");for(let e=0;e<n.length&&e<i.length;e++){const t=Vl(n[e],i[e]);if(0!==t)return t}return Vl(n.length,i.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=Vl(vu(e.latitude),vu(t.latitude));return 0!==n?n:Vl(vu(e.longitude),vu(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],i=t.values||[];for(let e=0;e<n.length&&e<i.length;++e){const t=Nu(n[e],i[e]);if(t)return t}return Vl(n.length,i.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===Su.mapValue&&t===Su.mapValue)return 0;if(e===Su.mapValue)return 1;if(t===Su.mapValue)return-1;const n=e.fields||{},i=Object.keys(n),r=t.fields||{},s=Object.keys(r);i.sort(),s.sort();for(let e=0;e<i.length&&e<s.length;++e){const t=Vl(i[e],s[e]);if(0!==t)return t;const o=Nu(n[i[e]],r[s[e]]);if(0!==o)return o}return Vl(i.length,s.length)}(e.mapValue,t.mapValue);default:throw Tl()}}function Du(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Vl(e,t);const n=yu(e),i=yu(t),r=Vl(n.seconds,i.seconds);return 0!==r?r:Vl(n.nanos,i.nanos)}function Ru(e){return Ou(e)}function Ou(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=yu(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?wu(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,Gl.fromName(n).toString()):"geoPointValue"in e?`geo(${(t=e.geoPointValue).latitude},${t.longitude})`:"arrayValue"in e?function(e){let t="[",n=!0;for(const i of e.values||[])n?n=!1:t+=",",t+=Ou(i);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",i=!0;for(const r of t)i?i=!1:n+=",",n+=`${r}:${Ou(e.fields[r])}`;return n+"}"}(e.mapValue):Tl();var t,n}function Pu(e){return!!e&&"integerValue"in e}function Lu(e){return!!e&&"arrayValue"in e}function Mu(e){return!!e&&"mapValue"in e}function xu(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return ou(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=xu(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=xu(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Fu(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class Uu{constructor(e){this.value=e}static empty(){return new Uu({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Mu(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=xu(t)}setAll(e){let t=ql.emptyPath(),n={},i=[];e.forEach(((e,r)=>{if(!t.isImmediateParentOf(r)){const e=this.getFieldsMap(t);this.applyChanges(e,n,i),n={},i=[],t=r.popLast()}e?n[r.lastSegment()]=xu(e):i.push(r.lastSegment())}));const r=this.getFieldsMap(t);this.applyChanges(r,n,i)}delete(e){const t=this.field(e.popLast());Mu(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Cu(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];Mu(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){ou(t,((t,n)=>e[t]=n));for(const t of n)delete e[t]}clone(){return new Uu(xu(this.value))}}function Vu(e){const t=[];return ou(e.fields,((e,n)=>{const i=new ql([e]);if(Mu(n)){const e=Vu(n.mapValue).fields;if(0===e.length)t.push(i);else for(const n of e)t.push(i.child(n))}else t.push(i)})),new fu(t)}class ju{constructor(e,t,n,i,r,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=r,this.data=s,this.documentState=o}static newInvalidDocument(e){return new ju(e,0,$l.min(),$l.min(),$l.min(),Uu.empty(),0)}static newFoundDocument(e,t,n,i){return new ju(e,1,t,$l.min(),n,i,0)}static newNoDocument(e,t){return new ju(e,2,t,$l.min(),$l.min(),Uu.empty(),0)}static newUnknownDocument(e,t){return new ju(e,3,t,$l.min(),$l.min(),Uu.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual($l.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Uu.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Uu.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=$l.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof ju&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ju(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Bu{constructor(e,t){this.position=e,this.inclusive=t}}function $u(e,t,n){let i=0;for(let r=0;r<e.position.length;r++){const s=t[r],o=e.position[r];if(i=s.field.isKeyField()?Gl.comparator(Gl.fromName(o.referenceValue),n.key):Nu(o,n.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return i}function Hu(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Cu(e.position[n],t.position[n]))return!1;return!0}class zu{constructor(e,t="asc"){this.field=e,this.dir=t}}function Ku(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class qu{}class Gu extends qu{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new eh(e,t,n):"array-contains"===t?new rh(e,n):"in"===t?new sh(e,n):"not-in"===t?new oh(e,n):"array-contains-any"===t?new ah(e,n):new Gu(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new th(e,n):new nh(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Nu(t,this.value)):null!==t&&Au(this.value)===Au(t)&&this.matchesComparison(Nu(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Tl()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class Wu extends qu{constructor(e,t){super(),this.filters=e,this.op=t,this.lt=null}static create(e,t){return new Wu(e,t)}matches(e){return Qu(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.lt||(this.lt=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft((e=>e.isInequality()));return null!==e?e.field:null}ft(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function Qu(e){return"and"===e.op}function Xu(e){return function(e){for(const t of e.filters)if(t instanceof Wu)return!1;return!0}(e)&&Qu(e)}function Ju(e){if(e instanceof Gu)return e.field.canonicalString()+e.op.toString()+Ru(e.value);if(Xu(e))return e.filters.map((e=>Ju(e))).join(",");{const t=e.filters.map((e=>Ju(e))).join(",");return`${e.op}(${t})`}}function Yu(e,t){return e instanceof Gu?function(e,t){return t instanceof Gu&&e.op===t.op&&e.field.isEqual(t.field)&&Cu(e.value,t.value)}(e,t):e instanceof Wu?function(e,t){return t instanceof Wu&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,i)=>e&&Yu(n,t.filters[i])),!0)}(e,t):void Tl()}function Zu(e){return e instanceof Gu?function(e){return`${e.field.canonicalString()} ${e.op} ${Ru(e.value)}`}(e):e instanceof Wu?function(e){return e.op.toString()+" {"+e.getFilters().map(Zu).join(" ,")+"}"}(e):"Filter"}class eh extends Gu{constructor(e,t,n){super(e,t,n),this.key=Gl.fromName(n.referenceValue)}matches(e){const t=Gl.comparator(e.key,this.key);return this.matchesComparison(t)}}class th extends Gu{constructor(e,t){super(e,"in",t),this.keys=ih(0,t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class nh extends Gu{constructor(e,t){super(e,"not-in",t),this.keys=ih(0,t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function ih(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>Gl.fromName(e.referenceValue)))}class rh extends Gu{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Lu(t)&&ku(t.arrayValue,this.value)}}class sh extends Gu{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&ku(this.value.arrayValue,t)}}class oh extends Gu{constructor(e,t){super(e,"not-in",t)}matches(e){if(ku(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!ku(this.value.arrayValue,t)}}class ah extends Gu{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Lu(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>ku(this.value.arrayValue,e)))}}class ch{constructor(e,t=null,n=[],i=[],r=null,s=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=s,this.endAt=o,this.dt=null}}function lh(e,t=null,n=[],i=[],r=null,s=null,o=null){return new ch(e,t,n,i,r,s,o)}function uh(e){const t=Sl(e);if(null===t.dt){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>Ju(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),iu(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>Ru(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>Ru(e))).join(",")),t.dt=e}return t.dt}function hh(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Ku(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Yu(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Hu(e.startAt,t.startAt)&&Hu(e.endAt,t.endAt)}class dh{constructor(e,t=null,n=[],i=[],r=null,s="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=r,this.limitType=s,this.startAt=o,this.endAt=a,this.wt=null,this._t=null,this.startAt,this.endAt}}function fh(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function ph(e){const t=Sl(e);if(null===t.wt){t.wt=[];const e=function(e){for(const t of e.filters){const e=t.getFirstInequalityField();if(null!==e)return e}return null}(t),n=function(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}(t);if(null!==e&&null===n)e.isKeyField()||t.wt.push(new zu(e)),t.wt.push(new zu(ql.keyField(),"asc"));else{let e=!1;for(const n of t.explicitOrderBy)t.wt.push(n),n.field.isKeyField()&&(e=!0);if(!e){const e=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.wt.push(new zu(ql.keyField(),e))}}}return t.wt}function gh(e){const t=Sl(e);if(!t._t)if("F"===t.limitType)t._t=lh(t.path,t.collectionGroup,ph(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const n of ph(t)){const t="desc"===n.dir?"asc":"desc";e.push(new zu(n.field,t))}const n=t.endAt?new Bu(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new Bu(t.startAt.position,t.startAt.inclusive):null;t._t=lh(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}return t._t}function mh(e,t,n){return new dh(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function yh(e,t){return hh(gh(e),gh(t))&&e.limitType===t.limitType}function vh(e){return`${uh(gh(e))}|lt:${e.limitType}`}function wh(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>Zu(e))).join(", ")}]`),iu(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>Ru(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>Ru(e))).join(",")),`Target(${t})`}(gh(e))}; limitType=${e.limitType})`}function Ih(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Gl.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of ph(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const i=$u(e,t,n);return e.inclusive?i<=0:i<0}(e.startAt,ph(e),t)||e.endAt&&!function(e,t,n){const i=$u(e,t,n);return e.inclusive?i>=0:i>0}(e.endAt,ph(e),t))}(e,t)}function bh(e,t,n){const i=e.field.isKeyField()?Gl.comparator(t.key,n.key):function(e,t,n){const i=t.data.field(e),r=n.data.field(e);return null!==i&&null!==r?Nu(i,r):Tl()}(e.field,t,n);switch(e.dir){case"asc":return i;case"desc":return-1*i;default:return Tl()}}class Eh{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[t,i]of n)if(this.equalsFn(t,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(void 0===i)return this.inner[n]=[[e,t]],void this.innerSize++;for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],e))return void(i[n]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return 1===n.length?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ou(this.inner,((t,n)=>{for(const[t,i]of n)e(t,i)}))}isEmpty(){return au(this.inner)}size(){return this.innerSize}}const Th=new cu(Gl.comparator);function _h(){return Th}const Sh=new cu(Gl.comparator);function Ah(...e){let t=Sh;for(const n of e)t=t.insert(n.key,n);return t}function Ch(e){let t=Sh;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function kh(){return Dh()}function Nh(){return Dh()}function Dh(){return new Eh((e=>e.toString()),((e,t)=>e.isEqual(t)))}const Rh=new cu(Gl.comparator),Oh=new hu(Gl.comparator);function Ph(...e){let t=Oh;for(const n of e)t=t.add(n);return t}const Lh=new hu(Vl);function Mh(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ru(t)?"-0":t}}function xh(e){return{integerValue:""+e}}function Fh(e,t){return function(e){return"number"==typeof e&&Number.isInteger(e)&&!ru(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}(t)?xh(t):Mh(e,t)}class Uh{constructor(){this._=void 0}}function Vh(e,t,n){return e instanceof $h?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Iu(t)&&(t=bu(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof Hh?zh(e,t):e instanceof Kh?qh(e,t):function(e,t){const n=Bh(e,t),i=Wh(n)+Wh(e.gt);return Pu(n)&&Pu(e.gt)?xh(i):Mh(e.serializer,i)}(e,t)}function jh(e,t,n){return e instanceof Hh?zh(e,t):e instanceof Kh?qh(e,t):n}function Bh(e,t){return e instanceof Gh?Pu(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}class $h extends Uh{}class Hh extends Uh{constructor(e){super(),this.elements=e}}function zh(e,t){const n=Qh(t);for(const t of e.elements)n.some((e=>Cu(e,t)))||n.push(t);return{arrayValue:{values:n}}}class Kh extends Uh{constructor(e){super(),this.elements=e}}function qh(e,t){let n=Qh(t);for(const t of e.elements)n=n.filter((e=>!Cu(e,t)));return{arrayValue:{values:n}}}class Gh extends Uh{constructor(e,t){super(),this.serializer=e,this.gt=t}}function Wh(e){return vu(e.integerValue||e.doubleValue)}function Qh(e){return Lu(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Xh{constructor(e,t){this.version=e,this.transformResults=t}}class Jh{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Jh}static exists(e){return new Jh(void 0,e)}static updateTime(e){return new Jh(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Yh(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Zh{}function ed(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new ud(e.key,Jh.none()):new sd(e.key,e.data,Jh.none());{const n=e.data,i=Uu.empty();let r=new hu(ql.comparator);for(let e of t.fields)if(!r.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?i.delete(e):i.set(e,t),r=r.add(e)}return new od(e.key,i,new fu(r.toArray()),Jh.none())}}function td(e,t,n){e instanceof sd?function(e,t,n){const i=e.value.clone(),r=cd(e.fieldTransforms,t,n.transformResults);i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):e instanceof od?function(e,t,n){if(!Yh(e.precondition,t))return void t.convertToUnknownDocument(n.version);const i=cd(e.fieldTransforms,t,n.transformResults),r=t.data;r.setAll(ad(e)),r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function nd(e,t,n,i){return e instanceof sd?function(e,t,n,i){if(!Yh(e.precondition,t))return n;const r=e.value.clone(),s=ld(e.fieldTransforms,i,t);return r.setAll(s),t.convertToFoundDocument(t.version,r).setHasLocalMutations(),null}(e,t,n,i):e instanceof od?function(e,t,n,i){if(!Yh(e.precondition,t))return n;const r=ld(e.fieldTransforms,i,t),s=t.data;return s.setAll(ad(e)),s.setAll(r),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,i):function(e,t,n){return Yh(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function id(e,t){let n=null;for(const i of e.fieldTransforms){const e=t.data.field(i.field),r=Bh(i.transform,e||null);null!=r&&(null===n&&(n=Uu.empty()),n.set(i.field,r))}return n||null}function rd(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&jl(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Hh&&t instanceof Hh||e instanceof Kh&&t instanceof Kh?jl(e.elements,t.elements,Cu):e instanceof Gh&&t instanceof Gh?Cu(e.gt,t.gt):e instanceof $h&&t instanceof $h}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class sd extends Zh{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class od extends Zh{constructor(e,t,n,i,r=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function ad(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=e.data.field(n);t.set(n,i)}})),t}function cd(e,t,n){const i=new Map;_l(e.length===n.length);for(let r=0;r<n.length;r++){const s=e[r],o=s.transform,a=t.data.field(s.field);i.set(s.field,jh(o,a,n[r]))}return i}function ld(e,t,n){const i=new Map;for(const r of e){const e=r.transform,s=n.data.field(r.field);i.set(r.field,Vh(e,s,t))}return i}class ud extends Zh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class hd extends Zh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class dd{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){const i=this.mutations[t];i.key.isEqual(e.key)&&td(i,e,n[t])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=nd(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=nd(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Nh();return this.mutations.forEach((i=>{const r=e.get(i.key),s=r.overlayedDocument;let o=this.applyToLocalView(s,r.mutatedFields);o=t.has(i.key)?null:o;const a=ed(s,o);null!==a&&n.set(i.key,a),s.isValidDocument()||s.convertToNoDocument($l.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Ph())}isEqual(e){return this.batchId===e.batchId&&jl(this.mutations,e.mutations,((e,t)=>rd(e,t)))&&jl(this.baseMutations,e.baseMutations,((e,t)=>rd(e,t)))}}class fd{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){_l(e.mutations.length===n.length);let i=Rh;const r=e.mutations;for(let e=0;e<r.length;e++)i=i.insert(r[e].key,n[e].version);return new fd(e,t,n,i)}}class pd{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}var gd,md;(md=gd||(gd={}))[md.OK=0]="OK",md[md.CANCELLED=1]="CANCELLED",md[md.UNKNOWN=2]="UNKNOWN",md[md.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",md[md.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",md[md.NOT_FOUND=5]="NOT_FOUND",md[md.ALREADY_EXISTS=6]="ALREADY_EXISTS",md[md.PERMISSION_DENIED=7]="PERMISSION_DENIED",md[md.UNAUTHENTICATED=16]="UNAUTHENTICATED",md[md.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",md[md.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",md[md.ABORTED=10]="ABORTED",md[md.OUT_OF_RANGE=11]="OUT_OF_RANGE",md[md.UNIMPLEMENTED=12]="UNIMPLEMENTED",md[md.INTERNAL=13]="INTERNAL",md[md.UNAVAILABLE=14]="UNAVAILABLE",md[md.DATA_LOSS=15]="DATA_LOSS",new fl([4294967295,4294967295],0);class yd{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function vd(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function wd(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Id(e,t){return vd(e,t.toTimestamp())}function bd(e){return _l(!!e),$l.fromTimestamp(function(e){const t=yu(e);return new Bl(t.seconds,t.nanos)}(e))}function Ed(e,t){return function(e){return new zl(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function Td(e,t){return Ed(e.databaseId,t.path)}function _d(e){const t=function(e){const t=zl.fromString(e);return _l(function(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}(t)),t}(e);return 4===t.length?zl.emptyPath():function(e){return _l(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}(t)}function Sd(e,t,n){return{name:Td(e,t),fields:n.value.mapValue.fields}}function Ad(e){let t=_d(e.parent);const n=e.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){_l(1===i);const e=n.from[0];e.allDescendants?r=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=Cd(e);return t instanceof Wu&&Xu(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map((e=>function(e){return new zu(kd(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,iu(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){const t=!!e.before,n=e.values||[];return new Bu(n,t)}(n.startAt));let l=null;return n.endAt&&(l=function(e){const t=!e.before,n=e.values||[];return new Bu(n,t)}(n.endAt)),function(e,t,n,i,r,s,o,a){return new dh(e,t,n,i,r,s,o,a)}(t,r,o,s,a,"F",c,l)}function Cd(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=kd(e.unaryFilter.field);return Gu.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=kd(e.unaryFilter.field);return Gu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=kd(e.unaryFilter.field);return Gu.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=kd(e.unaryFilter.field);return Gu.create(r,"!=",{nullValue:"NULL_VALUE"});default:return Tl()}}(e):void 0!==e.fieldFilter?function(e){return Gu.create(kd(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Tl()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Wu.create(e.compositeFilter.filters.map((e=>Cd(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Tl()}}(e.compositeFilter.op))}(e):Tl()}function kd(e){return ql.fromServerFormat(e.fieldPath)}function Nd(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}class Dd{constructor(e){this.fe=e}}function Rd(e){const t=Ad({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?mh(t,t.limit,"L"):t}class Od{constructor(){}_e(e,t){this.me(e,t),t.ge()}me(e,t){if("nullValue"in e)this.ye(t,5);else if("booleanValue"in e)this.ye(t,10),t.pe(e.booleanValue?1:0);else if("integerValue"in e)this.ye(t,15),t.pe(vu(e.integerValue));else if("doubleValue"in e){const n=vu(e.doubleValue);isNaN(n)?this.ye(t,13):(this.ye(t,15),ru(n)?t.pe(0):t.pe(n))}else if("timestampValue"in e){const n=e.timestampValue;this.ye(t,20),"string"==typeof n?t.Ie(n):(t.Ie(`${n.seconds||""}`),t.pe(n.nanos||0))}else if("stringValue"in e)this.Te(e.stringValue,t),this.Ee(t);else if("bytesValue"in e)this.ye(t,30),t.Ae(wu(e.bytesValue)),this.Ee(t);else if("referenceValue"in e)this.ve(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ye(t,45),t.pe(n.latitude||0),t.pe(n.longitude||0)}else"mapValue"in e?Fu(e)?this.ye(t,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,t),this.Ee(t)):"arrayValue"in e?(this.Pe(e.arrayValue,t),this.Ee(t)):Tl()}Te(e,t){this.ye(t,25),this.be(e,t)}be(e,t){t.Ie(e)}Re(e,t){const n=e.fields||{};this.ye(t,55);for(const e of Object.keys(n))this.Te(e,t),this.me(n[e],t)}Pe(e,t){const n=e.values||[];this.ye(t,50);for(const e of n)this.me(e,t)}ve(e,t){this.ye(t,37),Gl.fromName(e).path.forEach((e=>{this.ye(t,60),this.be(e,t)}))}ye(e,t){e.pe(t)}Ee(e){e.pe(2)}}Od.Ve=new Od;class Pd{constructor(){this.rn=new Ld}addToCollectionParentIndex(e,t){return this.rn.add(t),eu.resolve()}getCollectionParents(e,t){return eu.resolve(this.rn.getEntries(t))}addFieldIndex(e,t){return eu.resolve()}deleteFieldIndex(e,t){return eu.resolve()}getDocumentsMatchingTarget(e,t){return eu.resolve(null)}getIndexType(e,t){return eu.resolve(0)}getFieldIndexes(e,t){return eu.resolve([])}getNextCollectionGroupToUpdate(e){return eu.resolve(null)}getMinOffset(e,t){return eu.resolve(Ql.min())}getMinOffsetFromCollectionGroup(e,t){return eu.resolve(Ql.min())}updateCollectionGroup(e,t,n){return eu.resolve()}updateIndexEntries(e,t){return eu.resolve()}}class Ld{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new hu(zl.comparator),r=!i.has(n);return this.index[t]=i.add(n),r}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new hu(zl.comparator)).toArray()}}new Uint8Array(0);class Md{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Md(e,Md.DEFAULT_COLLECTION_PERCENTILE,Md.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}Md.DEFAULT_COLLECTION_PERCENTILE=10,Md.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Md.DEFAULT=new Md(41943040,Md.DEFAULT_COLLECTION_PERCENTILE,Md.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Md.DISABLED=new Md(-1,0,0);class xd{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new xd(0)}static Mn(){return new xd(-1)}}class Fd{constructor(){this.changes=new Eh((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ju.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?eu.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Ud{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Vd{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(n=i,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&nd(n.mutation,e,fu.empty(),Bl.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,Ph()).next((()=>t))))}getLocalViewOfDocuments(e,t,n=Ph()){const i=kh();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,n).next((e=>{let t=Ah();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=kh();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,Ph())))}populateOverlays(e,t,n){const i=[];return n.forEach((e=>{t.has(e)||i.push(e)})),this.documentOverlayCache.getOverlays(e,i).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,i){let r=_h();const s=Dh(),o=Dh();return t.forEach(((e,t)=>{const o=n.get(t.key);i.has(t.key)&&(void 0===o||o.mutation instanceof od)?r=r.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),nd(o.mutation,t,o.mutation.getFieldMask(),Bl.now())):s.set(t.key,fu.empty())})),this.recalculateAndSaveOverlays(e,r).next((e=>(e.forEach(((e,t)=>s.set(e,t))),t.forEach(((e,t)=>{var n;return o.set(e,new Ud(t,null!==(n=s.get(e))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(e,t){const n=Dh();let i=new cu(((e,t)=>e-t)),r=Ph();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const r of e)r.keys().forEach((e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||fu.empty();o=r.applyToLocalView(s,o),n.set(e,o);const a=(i.get(r.batchId)||Ph()).add(e);i=i.insert(r.batchId,a)}))})).next((()=>{const s=[],o=i.getReverseIterator();for(;o.hasNext();){const i=o.getNext(),a=i.key,c=i.value,l=Nh();c.forEach((e=>{if(!r.has(e)){const i=ed(t.get(e),n.get(e));null!==i&&l.set(e,i),r=r.add(e)}})),s.push(this.documentOverlayCache.saveOverlays(e,a,l))}return eu.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n){return function(e){return Gl.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):function(e){return null!==e.collectionGroup}(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next((r=>{const s=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-r.size):eu.resolve(kh());let o=-1,a=r;return s.next((t=>eu.forEach(t,((t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),r.get(t)?eu.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{a=a.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,r))).next((()=>this.computeViews(e,a,t,Ph()))).next((e=>({batchId:o,changes:Ch(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Gl(t)).next((e=>{let t=Ah();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n){const i=t.collectionGroup;let r=Ah();return this.indexManager.getCollectionParents(e,i).next((s=>eu.forEach(s,(s=>{const o=function(e,t){return new dh(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(i));return this.getDocumentsMatchingCollectionQuery(e,o,n).next((e=>{e.forEach(((e,t)=>{r=r.insert(e,t)}))}))})).next((()=>r))))}getDocumentsMatchingCollectionQuery(e,t,n){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((r=>(i=r,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i)))).next((e=>{i.forEach(((t,n)=>{const i=n.getKey();null===e.get(i)&&(e=e.insert(i,ju.newInvalidDocument(i)))}));let n=Ah();return e.forEach(((e,r)=>{const s=i.get(e);void 0!==s&&nd(s.mutation,r,fu.empty(),Bl.now()),Ih(t,r)&&(n=n.insert(e,r))})),n}))}}class jd{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,t){return eu.resolve(this.cs.get(t))}saveBundleMetadata(e,t){var n;return this.cs.set(t.id,{id:(n=t).id,version:n.version,createTime:bd(n.createTime)}),eu.resolve()}getNamedQuery(e,t){return eu.resolve(this.hs.get(t))}saveNamedQuery(e,t){return this.hs.set(t.name,function(e){return{name:e.name,query:Rd(e.bundledQuery),readTime:bd(e.readTime)}}(t)),eu.resolve()}}class Bd{constructor(){this.overlays=new cu(Gl.comparator),this.ls=new Map}getOverlay(e,t){return eu.resolve(this.overlays.get(t))}getOverlays(e,t){const n=kh();return eu.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,i)=>{this.we(e,t,i)})),eu.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.ls.get(n);return void 0!==i&&(i.forEach((e=>this.overlays=this.overlays.remove(e))),this.ls.delete(n)),eu.resolve()}getOverlaysForCollection(e,t,n){const i=kh(),r=t.length+1,s=new Gl(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===r&&e.largestBatchId>n&&i.set(e.getKey(),e)}return eu.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let r=new cu(((e,t)=>e-t));const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=r.get(e.largestBatchId);null===t&&(t=kh(),r=r.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=kh(),a=r.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=i)););return eu.resolve(o)}we(e,t,n){const i=this.overlays.get(n.key);if(null!==i){const e=this.ls.get(i.largestBatchId).delete(n.key);this.ls.set(i.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new pd(t,n));let r=this.ls.get(t);void 0===r&&(r=Ph(),this.ls.set(t,r)),this.ls.set(t,r.add(n.key))}}class $d{constructor(){this.fs=new hu(Hd.ds),this.ws=new hu(Hd._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,t){const n=new Hd(e,t);this.fs=this.fs.add(n),this.ws=this.ws.add(n)}gs(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.ys(new Hd(e,t))}ps(e,t){e.forEach((e=>this.removeReference(e,t)))}Is(e){const t=new Gl(new zl([])),n=new Hd(t,e),i=new Hd(t,e+1),r=[];return this.ws.forEachInRange([n,i],(e=>{this.ys(e),r.push(e.key)})),r}Ts(){this.fs.forEach((e=>this.ys(e)))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const t=new Gl(new zl([])),n=new Hd(t,e),i=new Hd(t,e+1);let r=Ph();return this.ws.forEachInRange([n,i],(e=>{r=r.add(e.key)})),r}containsKey(e){const t=new Hd(e,0),n=this.fs.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Hd{constructor(e,t){this.key=e,this.As=t}static ds(e,t){return Gl.comparator(e.key,t.key)||Vl(e.As,t.As)}static _s(e,t){return Vl(e.As,t.As)||Gl.comparator(e.key,t.key)}}class zd{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.vs=1,this.Rs=new hu(Hd.ds)}checkEmpty(e){return eu.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,i){const r=this.vs;this.vs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new dd(r,t,n,i);this.mutationQueue.push(s);for(const t of i)this.Rs=this.Rs.add(new Hd(t.key,r)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return eu.resolve(s)}lookupMutationBatch(e,t){return eu.resolve(this.Ps(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.bs(n),r=i<0?0:i;return eu.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return eu.resolve(0===this.mutationQueue.length?-1:this.vs-1)}getAllMutationBatches(e){return eu.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Hd(t,0),i=new Hd(t,Number.POSITIVE_INFINITY),r=[];return this.Rs.forEachInRange([n,i],(e=>{const t=this.Ps(e.As);r.push(t)})),eu.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new hu(Vl);return t.forEach((e=>{const t=new Hd(e,0),i=new Hd(e,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([t,i],(e=>{n=n.add(e.As)}))})),eu.resolve(this.Vs(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let r=n;Gl.isDocumentKey(r)||(r=r.child(""));const s=new Hd(new Gl(r),0);let o=new hu(Vl);return this.Rs.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===i&&(o=o.add(e.As)),!0)}),s),eu.resolve(this.Vs(o))}Vs(e){const t=[];return e.forEach((e=>{const n=this.Ps(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){_l(0===this.Ss(t.batchId,"removed")),this.mutationQueue.shift();let n=this.Rs;return eu.forEach(t.mutations,(i=>{const r=new Hd(i.key,t.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Rs=n}))}Cn(e){}containsKey(e,t){const n=new Hd(t,0),i=this.Rs.firstAfterOrEqual(n);return eu.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,eu.resolve()}Ss(e,t){return this.bs(e)}bs(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Ps(e){const t=this.bs(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Kd{constructor(e){this.Ds=e,this.docs=new cu(Gl.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),r=i?i.size:0,s=this.Ds(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-r,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return eu.resolve(n?n.document.mutableCopy():ju.newInvalidDocument(t))}getEntries(e,t){let n=_h();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():ju.newInvalidDocument(e))})),eu.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let r=_h();const s=t.path,o=new Gl(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||Xl(Wl(o),n)<=0||(i.has(o.key)||Ih(t,o))&&(r=r.insert(o.key,o.mutableCopy()))}return eu.resolve(r)}getAllFromCollectionGroup(e,t,n,i){Tl()}Cs(e,t){return eu.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new qd(this)}getSize(e){return eu.resolve(this.size)}}class qd extends Fd{constructor(e){super(),this.os=e}applyChanges(e){const t=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?t.push(this.os.addEntry(e,i)):this.os.removeEntry(n)})),eu.waitFor(t)}getFromCache(e,t){return this.os.getEntry(e,t)}getAllFromCache(e,t){return this.os.getEntries(e,t)}}class Gd{constructor(e){this.persistence=e,this.xs=new Eh((e=>uh(e)),hh),this.lastRemoteSnapshotVersion=$l.min(),this.highestTargetId=0,this.Ns=0,this.ks=new $d,this.targetCount=0,this.Ms=xd.kn()}forEachTarget(e,t){return this.xs.forEach(((e,n)=>t(n))),eu.resolve()}getLastRemoteSnapshotVersion(e){return eu.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return eu.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),eu.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Ns&&(this.Ns=t),eu.resolve()}Fn(e){this.xs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ms=new xd(t),this.highestTargetId=t),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,t){return this.Fn(t),this.targetCount+=1,eu.resolve()}updateTargetData(e,t){return this.Fn(t),eu.resolve()}removeTargetData(e,t){return this.xs.delete(t.target),this.ks.Is(t.targetId),this.targetCount-=1,eu.resolve()}removeTargets(e,t,n){let i=0;const r=[];return this.xs.forEach(((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.xs.delete(s),r.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)})),eu.waitFor(r).next((()=>i))}getTargetCount(e){return eu.resolve(this.targetCount)}getTargetData(e,t){const n=this.xs.get(t)||null;return eu.resolve(n)}addMatchingKeys(e,t,n){return this.ks.gs(t,n),eu.resolve()}removeMatchingKeys(e,t,n){this.ks.ps(t,n);const i=this.persistence.referenceDelegate,r=[];return i&&t.forEach((t=>{r.push(i.markPotentiallyOrphaned(e,t))})),eu.waitFor(r)}removeMatchingKeysForTargetId(e,t){return this.ks.Is(t),eu.resolve()}getMatchingKeysForTargetId(e,t){const n=this.ks.Es(t);return eu.resolve(n)}containsKey(e,t){return eu.resolve(this.ks.containsKey(t))}}class Wd{constructor(e,t){this.$s={},this.overlays={},this.Os=new nu(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new Gd(this),this.indexManager=new Pd,this.remoteDocumentCache=function(e){return new Kd(e)}((e=>this.referenceDelegate.Ls(e))),this.serializer=new Dd(t),this.qs=new jd(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Bd,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.$s[e.toKey()];return n||(n=new zd(t,this.referenceDelegate),this.$s[e.toKey()]=n),n}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,t,n){wl("MemoryPersistence","Starting transaction:",e);const i=new Qd(this.Os.next());return this.referenceDelegate.Us(),n(i).next((e=>this.referenceDelegate.Ks(i).next((()=>e)))).toPromise().then((e=>(i.raiseOnCommittedEvent(),e)))}Gs(e,t){return eu.or(Object.values(this.$s).map((n=>()=>n.containsKey(e,t))))}}class Qd extends Yl{constructor(e){super(),this.currentSequenceNumber=e}}class Xd{constructor(e){this.persistence=e,this.Qs=new $d,this.js=null}static zs(e){return new Xd(e)}get Ws(){if(this.js)return this.js;throw Tl()}addReference(e,t,n){return this.Qs.addReference(n,t),this.Ws.delete(n.toString()),eu.resolve()}removeReference(e,t,n){return this.Qs.removeReference(n,t),this.Ws.add(n.toString()),eu.resolve()}markPotentiallyOrphaned(e,t){return this.Ws.add(t.toString()),eu.resolve()}removeTarget(e,t){this.Qs.Is(t.targetId).forEach((e=>this.Ws.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Ws.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Us(){this.js=new Set}Ks(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return eu.forEach(this.Ws,(n=>{const i=Gl.fromPath(n);return this.Hs(e,i).next((e=>{e||t.removeEntry(i,$l.min())}))})).next((()=>(this.js=null,t.apply(e))))}updateLimboDocument(e,t){return this.Hs(e,t).next((e=>{e?this.Ws.delete(t.toString()):this.Ws.add(t.toString())}))}Ls(e){return 0}Hs(e,t){return eu.or([()=>eu.resolve(this.Qs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gs(e,t)])}}class Jd{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Fi=n,this.Bi=i}static Li(e,t){let n=Ph(),i=Ph();for(const e of t.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:i=i.add(e.doc.key)}return new Jd(e,t.fromCache,n,i)}}class Yd{constructor(){this.qi=!1}initialize(e,t){this.Ui=e,this.indexManager=t,this.qi=!0}getDocumentsMatchingQuery(e,t,n,i){return this.Ki(e,t).next((r=>r||this.Gi(e,t,i,n))).next((n=>n||this.Qi(e,t)))}Ki(e,t){if(fh(t))return eu.resolve(null);let n=gh(t);return this.indexManager.getIndexType(e,n).next((i=>0===i?null:(null!==t.limit&&1===i&&(t=mh(t,null,"F"),n=gh(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((i=>{const r=Ph(...i);return this.Ui.getDocuments(e,r).next((i=>this.indexManager.getMinOffset(e,n).next((n=>{const s=this.ji(t,i);return this.zi(t,s,r,n.readTime)?this.Ki(e,mh(t,null,"F")):this.Wi(e,s,t,n)}))))})))))}Gi(e,t,n,i){return fh(t)||i.isEqual($l.min())?this.Qi(e,t):this.Ui.getDocuments(e,n).next((r=>{const s=this.ji(t,r);return this.zi(t,s,n,i)?this.Qi(e,t):(vl()<=x.DEBUG&&wl("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),wh(t)),this.Wi(e,s,t,function(e,t){const n=e.toTimestamp().seconds,i=e.toTimestamp().nanoseconds+1,r=$l.fromTimestamp(1e9===i?new Bl(n+1,0):new Bl(n,i));return new Ql(r,Gl.empty(),t)}(i,-1)))}))}ji(e,t){let n=new hu(function(e){return(t,n)=>{let i=!1;for(const r of ph(e)){const e=bh(r,t,n);if(0!==e)return e;i=i||r.field.isKeyField()}return 0}}(e));return t.forEach(((t,i)=>{Ih(e,i)&&(n=n.add(i))})),n}zi(e,t,n,i){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const r="F"===e.limitType?t.last():t.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Qi(e,t){return vl()<=x.DEBUG&&wl("QueryEngine","Using full collection scan to execute query:",wh(t)),this.Ui.getDocumentsMatchingQuery(e,t,Ql.min())}Wi(e,t,n,i){return this.Ui.getDocumentsMatchingQuery(e,n,i).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class Zd{constructor(e,t,n,i){this.persistence=e,this.Hi=t,this.serializer=i,this.Ji=new cu(Vl),this.Yi=new Eh((e=>uh(e)),hh),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(n)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Vd(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ji)))}}async function ef(e,t){const n=Sl(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let i;return n.mutationQueue.getAllMutationBatches(e).next((r=>(i=r,n.tr(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const r=[],s=[];let o=Ph();for(const e of i){r.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next((e=>({er:e,removedBatchIds:r,addedBatchIds:s})))}))}))}function tf(e,t){const n=Sl(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}class nf{constructor(){this.activeTargetIds=Lh}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class rf{constructor(){this.Hr=new nf,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,t,n){this.Jr[e]=t}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new nf,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class sf{Yr(e){}shutdown(){}}class of{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){wl("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){wl("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let af=null;function cf(){return null===af?af=268435456+Math.round(2147483648*Math.random()):af++,"0x"+af.toString(16)}const lf={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class uf{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}const hf="WebChannelConnection";class df extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http";this.mo=t+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,t,n,i,r){const s=cf(),o=this.To(e,t);wl("RestConnection",`Sending RPC '${e}' ${s}:`,o,n);const a={};return this.Eo(a,i,r),this.Ao(e,o,a,n).then((t=>(wl("RestConnection",`Received RPC '${e}' ${s}: `,t),t)),(t=>{throw bl("RestConnection",`RPC '${e}' ${s} failed with error: `,t,"url: ",o,"request:",n),t}))}vo(e,t,n,i,r,s){return this.Io(e,t,n,i,r)}Eo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+ml,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}To(e,t){const n=lf[e];return`${this.mo}/v1/${t}:${n}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,t,n,i){const r=cf();return new Promise(((s,o)=>{const a=new dl;a.setWithCredentials(!0),a.listenOnce(al.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case ol.NO_ERROR:const t=a.getResponseJson();wl(hf,`XHR for RPC '${e}' ${r} received:`,JSON.stringify(t)),s(t);break;case ol.TIMEOUT:wl(hf,`RPC '${e}' ${r} timed out`),o(new Cl(Al.DEADLINE_EXCEEDED,"Request time out"));break;case ol.HTTP_ERROR:const n=a.getStatus();if(wl(hf,`RPC '${e}' ${r} failed with status:`,n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Al).indexOf(t)>=0?t:Al.UNKNOWN}(t.status);o(new Cl(e,t.message))}else o(new Cl(Al.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new Cl(Al.UNAVAILABLE,"Connection failed."));break;default:Tl()}}finally{wl(hf,`RPC '${e}' ${r} completed.`)}}));const c=JSON.stringify(i);wl(hf,`RPC '${e}' ${r} sending request:`,i),a.send(t,"POST",c,n,15)}))}Ro(e,t,n){const i=cf(),r=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=rl(),o=sl(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.xmlHttpFactory=new ul({})),this.Eo(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const l=r.join("");wl(hf,`Creating RPC '${e}' stream ${i}: ${l}`,a);const u=s.createWebChannel(l,a);let h=!1,d=!1;const f=new uf({ro:t=>{d?wl(hf,`Not sending because RPC '${e}' stream ${i} is closed:`,t):(h||(wl(hf,`Opening RPC '${e}' stream ${i} transport.`),u.open(),h=!0),wl(hf,`RPC '${e}' stream ${i} sending:`,t),u.send(t))},oo:()=>u.close()}),p=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return p(u,hl.EventType.OPEN,(()=>{d||wl(hf,`RPC '${e}' stream ${i} transport opened.`)})),p(u,hl.EventType.CLOSE,(()=>{d||(d=!0,wl(hf,`RPC '${e}' stream ${i} transport closed`),f.wo())})),p(u,hl.EventType.ERROR,(t=>{d||(d=!0,bl(hf,`RPC '${e}' stream ${i} transport errored:`,t),f.wo(new Cl(Al.UNAVAILABLE,"The operation could not be completed")))})),p(u,hl.EventType.MESSAGE,(t=>{var n;if(!d){const r=t.data[0];_l(!!r);const s=r,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){wl(hf,`RPC '${e}' stream ${i} received error:`,o);const t=o.status;let n=function(e){const t=gd[e];if(void 0!==t)return function(e){if(void 0===e)return Il("GRPC error has no .code"),Al.UNKNOWN;switch(e){case gd.OK:return Al.OK;case gd.CANCELLED:return Al.CANCELLED;case gd.UNKNOWN:return Al.UNKNOWN;case gd.DEADLINE_EXCEEDED:return Al.DEADLINE_EXCEEDED;case gd.RESOURCE_EXHAUSTED:return Al.RESOURCE_EXHAUSTED;case gd.INTERNAL:return Al.INTERNAL;case gd.UNAVAILABLE:return Al.UNAVAILABLE;case gd.UNAUTHENTICATED:return Al.UNAUTHENTICATED;case gd.INVALID_ARGUMENT:return Al.INVALID_ARGUMENT;case gd.NOT_FOUND:return Al.NOT_FOUND;case gd.ALREADY_EXISTS:return Al.ALREADY_EXISTS;case gd.PERMISSION_DENIED:return Al.PERMISSION_DENIED;case gd.FAILED_PRECONDITION:return Al.FAILED_PRECONDITION;case gd.ABORTED:return Al.ABORTED;case gd.OUT_OF_RANGE:return Al.OUT_OF_RANGE;case gd.UNIMPLEMENTED:return Al.UNIMPLEMENTED;case gd.DATA_LOSS:return Al.DATA_LOSS;default:return Tl()}}(t)}(t),r=o.message;void 0===n&&(n=Al.INTERNAL,r="Unknown error status: "+t+" with message "+o.message),d=!0,f.wo(new Cl(n,r)),u.close()}else wl(hf,`RPC '${e}' stream ${i} received:`,r),f._o(r)}})),p(o,cl.STAT_EVENT,(t=>{t.stat===ll.PROXY?wl(hf,`RPC '${e}' stream ${i} detected buffering proxy`):t.stat===ll.NOPROXY&&wl(hf,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{f.fo()}),0),f}}function ff(){return"undefined"!=typeof document?document:null}function pf(e){return new yd(e,!0)}class gf{constructor(e,t,n=1e3,i=1.5,r=6e4){this.ii=e,this.timerId=t,this.Po=n,this.bo=i,this.Vo=r,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const t=Math.floor(this.So+this.ko()),n=Math.max(0,Date.now()-this.Co),i=Math.max(0,t-n);i>0&&wl("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.So} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,i,(()=>(this.Co=Date.now(),e()))),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}cancel(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}class mf{constructor(e,t,n,i,r,s,o,a){this.ii=e,this.$o=n,this.Oo=i,this.connection=r,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new gf(e,t)}Uo(){return 1===this.state||5===this.state||this.Ko()}Ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Go()}async stop(){this.Uo()&&await this.close(0)}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,(()=>this.zo())))}Wo(e){this.Ho(),this.stream.send(e)}async zo(){if(this.Ko())return this.close(0)}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}async close(e,t){this.Ho(),this.Jo(),this.qo.cancel(),this.Fo++,4!==e?this.qo.reset():t&&t.code===Al.RESOURCE_EXHAUSTED?(Il(t.toString()),Il("Using maximum backoff delay to prevent overloading the backend."),this.qo.xo()):t&&t.code===Al.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Yo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.ao(t)}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),t=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([e,n])=>{this.Fo===t&&this.Zo(e,n)}),(t=>{e((()=>{const e=new Cl(Al.UNKNOWN,"Fetching auth token failed: "+t.message);return this.tu(e)}))}))}Zo(e,t){const n=this.Xo(this.Fo);this.stream=this.eu(e,t),this.stream.uo((()=>{n((()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,(()=>(this.Ko()&&(this.state=3),Promise.resolve()))),this.listener.uo())))})),this.stream.ao((e=>{n((()=>this.tu(e)))})),this.stream.onMessage((e=>{n((()=>this.onMessage(e)))}))}Go(){this.state=5,this.qo.No((async()=>{this.state=0,this.start()}))}tu(e){return wl("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return t=>{this.ii.enqueueAndForget((()=>this.Fo===e?t():(wl("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class yf extends mf{constructor(e,t,n,i,r,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,s),this.serializer=r,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,t){return this.connection.Ro("Write",e,t)}onMessage(e){if(_l(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const t=function(e,t){return e&&e.length>0?(_l(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?bd(e.updateTime):bd(t);return n.isEqual($l.min())&&(n=bd(t)),new Xh(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=bd(e.commitTime);return this.listener.cu(n,t)}return _l(!e.writeResults||0===e.writeResults.length),this.ru=!0,this.listener.au()}hu(){const e={};e.database=function(e){return new zl(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}(this.serializer),this.Wo(e)}uu(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>function(e,t){let n;if(t instanceof sd)n={update:Sd(e,t.key,t.value)};else if(t instanceof ud)n={delete:Td(e,t.key)};else if(t instanceof od)n={update:Sd(e,t.key,t.data),updateMask:Nd(t.fieldMask)};else{if(!(t instanceof hd))return Tl();n={verify:Td(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof $h)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Hh)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Kh)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Gh)return{fieldPath:t.field.canonicalString(),increment:n.gt};throw Tl()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Id(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Tl()}(e,t.precondition)),n}(this.serializer,e)))};this.Wo(t)}}class vf extends class{}{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.lu=!1}fu(){if(this.lu)throw new Cl(Al.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,t,n){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,r])=>this.connection.Io(e,t,n,i,r))).catch((e=>{throw"FirebaseError"===e.name?(e.code===Al.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Cl(Al.UNKNOWN,e.toString())}))}vo(e,t,n,i){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,s])=>this.connection.vo(e,t,n,r,s,i))).catch((e=>{throw"FirebaseError"===e.name?(e.code===Al.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Cl(Al.UNKNOWN,e.toString())}))}terminate(){this.lu=!0}}class wf{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve()))))}Iu(e){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,"Online"===e&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(Il(t),this.mu=!1):wl("OnlineStateTracker",t)}Tu(){null!==this._u&&(this._u.cancel(),this._u=null)}}class If{constructor(e,t,n,i,r){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=r,this.Pu.Yr((e=>{n.enqueueAndForget((async()=>{Tf(this)&&(wl("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=Sl(e);t.vu.add(4),await Ef(t),t.bu.set("Unknown"),t.vu.delete(4),await bf(t)}(this))}))})),this.bu=new wf(n,i)}}async function bf(e){if(Tf(e))for(const t of e.Ru)await t(!0)}async function Ef(e){for(const t of e.Ru)await t(!1)}function Tf(e){return 0===Sl(e).vu.size}async function _f(e,t,n){if(!tu(t))throw t;e.vu.add(1),await Ef(e),e.bu.set("Offline"),n||(n=()=>function(e){const t=Sl(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Bs.getLastRemoteSnapshotVersion(e)))}(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{wl("RemoteStore","Retrying IndexedDB access"),await n(),e.vu.delete(1),await bf(e)}))}function Sf(e,t){return t().catch((n=>_f(e,n,t)))}async function Af(e){const t=Sl(e),n=xf(t);let i=t.Eu.length>0?t.Eu[t.Eu.length-1].batchId:-1;for(;Cf(t);)try{const e=await tf(t.localStore,i);if(null===e){0===t.Eu.length&&n.jo();break}i=e.batchId,kf(t,e)}catch(e){await _f(t,e)}Nf(t)&&Df(t)}function Cf(e){return Tf(e)&&e.Eu.length<10}function kf(e,t){e.Eu.push(t);const n=xf(e);n.Ko()&&n.ou&&n.uu(t.mutations)}function Nf(e){return Tf(e)&&!xf(e).Uo()&&e.Eu.length>0}function Df(e){xf(e).start()}async function Rf(e){xf(e).hu()}async function Of(e){const t=xf(e);for(const n of e.Eu)t.uu(n.mutations)}async function Pf(e,t,n){const i=e.Eu.shift(),r=fd.from(i,t,n);await Sf(e,(()=>e.remoteSyncer.applySuccessfulWrite(r))),await Af(e)}async function Lf(e,t){t&&xf(e).ou&&await async function(e,t){if(function(e){switch(e){default:return Tl();case Al.CANCELLED:case Al.UNKNOWN:case Al.DEADLINE_EXCEEDED:case Al.RESOURCE_EXHAUSTED:case Al.INTERNAL:case Al.UNAVAILABLE:case Al.UNAUTHENTICATED:return!1;case Al.INVALID_ARGUMENT:case Al.NOT_FOUND:case Al.ALREADY_EXISTS:case Al.PERMISSION_DENIED:case Al.FAILED_PRECONDITION:case Al.ABORTED:case Al.OUT_OF_RANGE:case Al.UNIMPLEMENTED:case Al.DATA_LOSS:return!0}}(n=t.code)&&n!==Al.ABORTED){const n=e.Eu.shift();xf(e).Qo(),await Sf(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await Af(e)}var n}(e,t),Nf(e)&&Df(e)}async function Mf(e,t){const n=Sl(e);n.asyncQueue.verifyOperationInProgress(),wl("RemoteStore","RemoteStore received new credentials");const i=Tf(n);n.vu.add(3),await Ef(n),i&&n.bu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.vu.delete(3),await bf(n)}function xf(e){return e.Du||(e.Du=function(e,t,n){const i=Sl(e);return i.fu(),new yf(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(e.datastore,e.asyncQueue,{uo:Rf.bind(null,e),ao:Lf.bind(null,e),au:Of.bind(null,e),cu:Pf.bind(null,e)}),e.Ru.push((async t=>{t?(e.Du.Qo(),await Af(e)):(await e.Du.stop(),e.Eu.length>0&&(wl("RemoteStore",`Stopping write stream with ${e.Eu.length} pending writes`),e.Eu=[]))}))),e.Du}class Ff{constructor(e,t,n,i,r){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new kl,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}static createAndSchedule(e,t,n,i,r){const s=Date.now()+n,o=new Ff(e,t,s,i,r);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Cl(Al.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Uf(e,t){if(Il("AsyncQueue",`${t}: ${e}`),tu(e))return new Cl(Al.UNAVAILABLE,`${t}: ${e}`);throw e}class Vf{constructor(){this.queries=new Eh((e=>vh(e)),yh),this.onlineState="Unknown",this.ku=new Set}}class jf{constructor(e,t,n,i,r,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=s,this.dc={},this.wc=new Eh((e=>vh(e)),yh),this._c=new Map,this.mc=new Set,this.gc=new cu(Gl.comparator),this.yc=new Map,this.Ic=new $d,this.Tc={},this.Ec=new Map,this.Ac=xd.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return!0===this.vc}}function Bf(e,t,n){const i=Sl(e);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const e=[];i.wc.forEach(((n,i)=>{const r=i.view.Mu(t);r.snapshot&&e.push(r.snapshot)})),function(e,t){const n=Sl(e);n.onlineState=t;let i=!1;n.queries.forEach(((e,n)=>{for(const e of n.listeners)e.Mu(t)&&(i=!0)})),i&&function(e){e.ku.forEach((e=>{e.next()}))}(n)}(i.eventManager,t),e.length&&i.dc.nu(e),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function $f(e,t){const n=Sl(e),i=t.batch.batchId;try{const e=await function(e,t){const n=Sl(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const i=t.batch.keys(),r=n.Zi.newChangeBuffer({trackRemovals:!0});return function(e,t,n,i){const r=n.batch,s=r.keys();let o=eu.resolve();return s.forEach((e=>{o=o.next((()=>i.getEntry(t,e))).next((t=>{const s=n.docVersions.get(e);_l(null!==s),t.version.compareTo(s)<0&&(r.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),i.addEntry(t)))}))})),o.next((()=>e.mutationQueue.removeMutationBatch(t,r)))}(n,e,t,r).next((()=>r.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,i,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Ph();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,i)))}))}(n.localStore,t);Kf(n,i,null),zf(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await qf(n,e)}catch(e){await Zl(e)}}async function Hf(e,t,n){const i=Sl(e);try{const e=await function(e,t){const n=Sl(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let i;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(_l(null!==t),i=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,i,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,i))).next((()=>n.localDocuments.getDocuments(e,i)))}))}(i.localStore,t);Kf(i,t,n),zf(i,t),i.sharedClientState.updateMutationState(t,"rejected",n),await qf(i,e)}catch(n){await Zl(n)}}function zf(e,t){(e.Ec.get(t)||[]).forEach((e=>{e.resolve()})),e.Ec.delete(t)}function Kf(e,t,n){const i=Sl(e);let r=i.Tc[i.currentUser.toKey()];if(r){const e=r.get(t);e&&(n?e.reject(n):e.resolve(),r=r.remove(t)),i.Tc[i.currentUser.toKey()]=r}}async function qf(e,t,n){const i=Sl(e),r=[],s=[],o=[];i.wc.isEmpty()||(i.wc.forEach(((e,a)=>{o.push(i.Rc(a,t,n).then((e=>{if((e||n)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(a.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){r.push(e);const t=Jd.Li(a.targetId,e);s.push(t)}})))})),await Promise.all(o),i.dc.nu(r),await async function(e,t){const n=Sl(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>eu.forEach(t,(t=>eu.forEach(t.Fi,(i=>n.persistence.referenceDelegate.addReference(e,t.targetId,i))).next((()=>eu.forEach(t.Bi,(i=>n.persistence.referenceDelegate.removeReference(e,t.targetId,i)))))))))}catch(e){if(!tu(e))throw e;wl("LocalStore","Failed to update sequence numbers: "+e)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=n.Ji.get(t),i=e.snapshotVersion,r=e.withLastLimboFreeSnapshotVersion(i);n.Ji=n.Ji.insert(t,r)}}}(i.localStore,s))}async function Gf(e,t){const n=Sl(e);if(!n.currentUser.isEqual(t)){wl("SyncEngine","User change. New user:",t.toKey());const e=await ef(n.localStore,t);n.currentUser=t,function(e,t){e.Ec.forEach((e=>{e.forEach((e=>{e.reject(new Cl(Al.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.Ec.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await qf(n,e.er)}}function Wf(e){const t=Sl(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=$f.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Hf.bind(null,t),t}class Qf{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=pf(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return function(e,t,n,i){return new Zd(e,t,n,i)}(this.persistence,new Yd,e.initialUser,this.serializer)}createPersistence(e){return new Wd(Xd.zs,this.serializer)}createSharedClientState(e){return new rf}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Xf{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Bf(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Gf.bind(null,this.syncEngine),await async function(e,t){const n=Sl(e);t?(n.vu.delete(2),await bf(n)):t||(n.vu.add(2),await Ef(n),n.bu.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Vf}createDatastore(e){const t=pf(e.databaseInfo.databaseId),n=(i=e.databaseInfo,new df(i));var i;return function(e,t,n,i){return new vf(e,t,n,i)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,i=e.asyncQueue,r=e=>Bf(this.syncEngine,e,0),s=of.D()?new of:new sf,new If(t,n,i,r,s);var t,n,i,r,s}createSyncEngine(e,t){return function(e,t,n,i,r,s,o){const a=new jf(e,t,n,i,r,s);return o&&(a.vc=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=Sl(e);wl("RemoteStore","RemoteStore shutting down."),t.vu.add(5),await Ef(t),t.Pu.shutdown(),t.bu.set("Unknown")}(this.remoteStore)}}class Jf{constructor(e,t,n,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=gl.UNAUTHENTICATED,this.clientId=Ul.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async e=>{wl("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(wl("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Cl(Al.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new kl;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Uf(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function Yf(e,t){e.asyncQueue.verifyOperationInProgress(),wl("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let i=n.initialUser;e.setCredentialChangeListener((async e=>{i.isEqual(e)||(await ef(t.localStore,e),i=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function Zf(e,t){e.asyncQueue.verifyOperationInProgress();const n=await async function(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){wl("FirestoreClient","Using user provided OfflineComponentProvider");try{await Yf(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===Al.FAILED_PRECONDITION||e.code===Al.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;bl("Error using user provided cache. Falling back to memory cache: "+n),await Yf(e,new Qf)}}else wl("FirestoreClient","Using default OfflineComponentProvider"),await Yf(e,new Qf);return e._offlineComponents}(e);wl("FirestoreClient","Initializing OnlineComponentProvider");const i=await e.getConfiguration();await t.initialize(n,i),e.setCredentialChangeListener((e=>Mf(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>Mf(t.remoteStore,n))),e._onlineComponents=t}function ep(e){return async function(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(wl("FirestoreClient","Using user provided OnlineComponentProvider"),await Zf(e,e._uninitializedComponentsProvider._online)):(wl("FirestoreClient","Using default OnlineComponentProvider"),await Zf(e,new Xf))),e._onlineComponents}(e).then((e=>e.syncEngine))}function tp(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const np=new Map;function ip(e,t,n){if(!n)throw new Cl(Al.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function rp(e){if(!Gl.isDocumentKey(e))throw new Cl(Al.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function sp(e){if(Gl.isDocumentKey(e))throw new Cl(Al.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function op(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":Tl()}function ap(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Cl(Al.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=op(e);throw new Cl(Al.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}class cp{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Cl(Al.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Cl(Al.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,i){if(!0===t&&!0===i)throw new Cl(Al.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")})(0,e.experimentalForceLongPolling,0,e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=tp(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Cl(Al.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new Cl(Al.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new Cl(Al.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,n=e.experimentalLongPollingOptions,t.timeoutSeconds===n.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var t,n}}class lp{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new cp({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Cl(Al.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Cl(Al.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new cp(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Dl;switch(e.type){case"firstParty":return new Ll(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Cl(Al.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=np.get(e);t&&(wl("ComponentProvider","Removing Datastore"),np.delete(e),t.terminate())}(this),Promise.resolve()}}class up{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new dp(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new up(this.firestore,e,this._key)}}class hp{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new hp(this.firestore,e,this._query)}}class dp extends hp{constructor(e,t,n){super(e,t,function(e){return new dh(e)}(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new up(this.firestore,null,new Gl(e))}withConverter(e){return new dp(this.firestore,e,this._path)}}class fp{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new gf(this,"async_queue_retry"),this.Xc=()=>{const e=ff();e&&wl("AsyncQueue","Visibility state changed to "+e.visibilityState),this.qo.Mo()};const e=ff();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const t=ff();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise((()=>{}));const t=new kl;return this.ta((()=>this.jc&&this.Jc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Qc.push(e),this.ea())))}async ea(){if(0!==this.Qc.length){try{await this.Qc[0](),this.Qc.shift(),this.qo.reset()}catch(e){if(!tu(e))throw e;wl("AsyncQueue","Operation failed with retryable error: "+e)}this.Qc.length>0&&this.qo.No((()=>this.ea()))}}ta(e){const t=this.Gc.then((()=>(this.Hc=!0,e().catch((e=>{this.Wc=e,this.Hc=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw Il("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.Hc=!1,e))))));return this.Gc=t,t}enqueueAfterDelay(e,t,n){this.Zc(),this.Yc.indexOf(e)>-1&&(t=0);const i=Ff.createAndSchedule(this,e,t,n,(e=>this.na(e)));return this.zc.push(i),i}Zc(){this.Wc&&Tl()}verifyOperationInProgress(){}async sa(){let e;do{e=this.Gc,await e}while(e!==this.Gc)}ia(e){for(const t of this.zc)if(t.timerId===e)return!0;return!1}ra(e){return this.sa().then((()=>{this.zc.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.zc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.sa()}))}oa(e){this.Yc.push(e)}na(e){const t=this.zc.indexOf(e);this.zc.splice(t,1)}}class pp extends lp{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new fp,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||gp(this),this._firestoreClient.terminate()}}function gp(e){var t,n,i;const r=e._freezeSettings(),s=function(e,t,n,i){return new Tu(e,t,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,tp(i.experimentalLongPollingOptions),i.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,r);e._firestoreClient=new Jf(e._authCredentials,e._appCheckCredentials,e._queue,s),(null===(n=r.cache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(i=r.cache)||void 0===i?void 0:i._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.cache.kind,_offline:r.cache._offlineComponentProvider,_online:r.cache._onlineComponentProvider})}class mp{constructor(e){this._byteString=e}static fromBase64String(e){try{return new mp(gu.fromBase64String(e))}catch(e){throw new Cl(Al.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new mp(gu.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class yp{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Cl(Al.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ql(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class vp{constructor(e){this._methodName=e}}class wp{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Cl(Al.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Cl(Al.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Vl(this._lat,e._lat)||Vl(this._long,e._long)}}const Ip=/^__.*__$/;class bp{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new od(e,this.data,this.fieldMask,t,this.fieldTransforms):new sd(e,this.data,t,this.fieldTransforms)}}function Ep(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Tl()}}class Tp{constructor(e,t,n,i,r,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===r&&this.ua(),this.fieldTransforms=r||[],this.fieldMask=s||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new Tp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.aa({path:n,la:!1});return i.fa(e),i}da(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.aa({path:n,la:!1});return i.ua(),i}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return Pp(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(0===e.length)throw this._a("Document fields must not be empty");if(Ep(this.ca)&&Ip.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class _p{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||pf(e)}ya(e,t,n,i=!1){return new Tp({ca:e,methodName:t,ga:n,path:ql.emptyPath(),la:!1,ma:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Sp(e){const t=e._freezeSettings(),n=pf(e._databaseId);return new _p(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Ap(e,t,n,i,r,s={}){const o=e.ya(s.merge||s.mergeFields?2:0,t,n,r);Dp("Data must be an object, but it was:",o,i);const a=kp(i,o);let c,l;if(s.merge)c=new fu(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const i of s.mergeFields){const r=Rp(t,i,n);if(!o.contains(r))throw new Cl(Al.INVALID_ARGUMENT,`Field '${r}' is specified in your field mask but missing from your input data.`);Lp(e,r)||e.push(r)}c=new fu(e),l=o.fieldTransforms.filter((e=>c.covers(e.field)))}else c=null,l=o.fieldTransforms;return new bp(new Uu(a),c,l)}function Cp(e,t){if(Np(e=D(e)))return Dp("Unsupported field value:",t,e),kp(e,t);if(e instanceof vp)return function(e,t){if(!Ep(t.ca))throw t._a(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t._a(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.la&&4!==t.ca)throw t._a("Nested arrays are not supported");return function(e,t){const n=[];let i=0;for(const r of e){let e=Cp(r,t.wa(i));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),i++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=D(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Fh(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Bl.fromDate(e);return{timestampValue:vd(t.serializer,n)}}if(e instanceof Bl){const n=new Bl(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:vd(t.serializer,n)}}if(e instanceof wp)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof mp)return{bytesValue:wd(t.serializer,e._byteString)};if(e instanceof up){const n=t.databaseId,i=e.firestore._databaseId;if(!i.isEqual(n))throw t._a(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Ed(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t._a(`Unsupported field value: ${op(e)}`)}(e,t)}function kp(e,t){const n={};return au(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):ou(e,((e,i)=>{const r=Cp(i,t.ha(e));null!=r&&(n[e]=r)})),{mapValue:{fields:n}}}function Np(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Bl||e instanceof wp||e instanceof mp||e instanceof up||e instanceof vp)}function Dp(e,t,n){if(!Np(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const i=op(n);throw"an object"===i?t._a(e+" a custom object"):t._a(e+" "+i)}}function Rp(e,t,n){if((t=D(t))instanceof yp)return t._internalPath;if("string"==typeof t)return function(e,t,n){if(t.search(Op)>=0)throw Pp(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new yp(...t.split("."))._internalPath}catch(i){throw Pp(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}(e,t);throw Pp("Field path arguments must be of type string or ",e,!1,void 0,n)}const Op=new RegExp("[~\\*/\\[\\]]");function Pp(e,t,n,i,r){const s=i&&!i.isEmpty(),o=void 0!==r;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${i}`),o&&(c+=` in document ${r}`),c+=")"),new Cl(Al.INVALID_ARGUMENT,a+e+c)}function Lp(e,t){return e.some((e=>e.isEqual(t)))}function Mp(e,t){const n=ap(e.firestore,pp),i=function(e,t,...n){if(e=D(e),1===arguments.length&&(t=Ul.A()),ip("doc","path",t),e instanceof lp){const i=zl.fromString(t,...n);return rp(i),new up(e,null,new Gl(i))}{if(!(e instanceof up||e instanceof dp))throw new Cl(Al.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(zl.fromString(t,...n));return rp(i),new up(e.firestore,e instanceof dp?e.converter:null,new Gl(i))}}(e),r=function(e,t,n){let i;return i=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,i}(e.converter,t);return function(e,t){return function(e,t){const n=new kl;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const i=Wf(e);try{const e=await function(e,t){const n=Sl(e),i=Bl.now(),r=t.reduce(((e,t)=>e.add(t.key)),Ph());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let a=_h(),c=Ph();return n.Zi.getEntries(e,r).next((e=>{a=e,a.forEach(((e,t)=>{t.isValidDocument()||(c=c.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,a))).next((r=>{s=r;const o=[];for(const e of t){const t=id(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new od(e.key,t,Vu(t.value.mapValue),Jh.exists(!0)))}return n.mutationQueue.addMutationBatch(e,i,o,t)})).next((t=>{o=t;const i=t.applyToLocalDocumentSet(s,c);return n.documentOverlayCache.saveOverlays(e,t.batchId,i)}))})).then((()=>({batchId:o.batchId,changes:Ch(s)})))}(i.localStore,t);i.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let i=e.Tc[e.currentUser.toKey()];i||(i=new cu(Vl)),i=i.insert(t,n),e.Tc[e.currentUser.toKey()]=i}(i,e.batchId,n),await qf(i,e.changes),await Af(i.remoteStore)}catch(e){const t=Uf(e,"Failed to persist write");n.reject(t)}}(await ep(e),t,n))),n.promise}(function(e){return e._firestoreClient||gp(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}(e),t)}(n,[Ap(Sp(e.firestore),"addDoc",i._key,r,null!==e.converter,{}).toMutation(i._key,Jh.exists(!1))]).then((()=>i))}!function(e,t=!0){!function(e){ml=e}(we),ge(new R("firestore",((e,{instanceIdentifier:n,options:i})=>{const r=e.getProvider("app").getImmediate(),s=new pp(new Ol(e.getProvider("auth-internal")),new xl(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Cl(Al.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new _u(e.options.projectId,t)}(r,n),r);return i=Object.assign({useFetchStreams:t},i),s._setSettings(i),s}),"PUBLIC").setMultipleInstances(!0)),Ee(pl,"3.13.0",e),Ee(pl,"3.13.0","esm2017")}(),function(e=be()){const t=me(e=D(e),Ft);t.isInitialized()?t.getImmediate():function(e,t={}){const n=me(e,Ft);if(n.isInitialized()){const e=n.getImmediate();if(v(t,n.getOptions()))return e;throw zt.create("already-initialized")}n.initialize({options:t})}(e)}(Ie({apiKey:"AIzaSyAzlMJB0WkUFXUXaD-GszRKxJayUo8tZQo",authDomain:"e-medibalance.firebaseapp.com",projectId:"e-medibalance",storageBucket:"e-medibalance.appspot.com",messagingSenderId:"117392039951",appId:"1:117392039951:web:eee754ac35979a36af437a",measurementId:"G-PG5LK8VTP9"})),new Fi;(function(e=be()){const t=me(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=me(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(v(n.getOptions(),null!=t?t:{}))return e;wn(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Hr,persistence:[ur,Gi,Qi]}),i=l("authTokenSyncURL");if(i){const e=(r=i,async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>Gr)return;const i=null==t?void 0:t.token;Wr!==i&&(Wr=i,await fetch(r,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});!function(e,t,n){D(e).beforeAuthStateChanged(t,n)}(n,e,(()=>e(n.currentUser))),function(t,n,i,r){D(t).onIdTokenChanged((t=>e(t)),void 0,void 0)}(n)}var r;const s=a("auth");return s&&function(e,t,n){const i=bi(e);En(i._canInitEmulator,i,"emulator-config-failed"),En(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const r=!!(null==n?void 0:n.disableWarnings),s=Ti(t),{host:o,port:a}=function(e){const t=Ti(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const e=r[1];return{host:e,port:_i(i.substr(e.length+1))}}{const[e,t]=i.split(":");return{host:e,port:_i(t)}}}(t),c=null===a?"":`:${a}`;i.config.emulator={url:`${s}//${o}${c}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}(n,`http://${s}`),n})().onAuthStateChanged((function(e){if(e)console.log(e),userName.textContent=e.displayName,signOutButton.style.display="block";else{console.log("User is not logged in");let e=document.getElementById("signInRequiredProgressBar"),t=document.getElementById("signInRequiredText");e.style.display="block",t.style.display="block",setTimeout((function(){location.href="./index.html"}),2e3)}}));const xp=function(e,t){const n=me(be(),"firestore").getImmediate({identifier:"(default)"});if(!n._initialized){const e=(e=>{const t=a("firestore");if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),i]:[t.substring(0,n),i]})();e&&function(e,t,n,i={}){var s;const o=(e=ap(e,lp))._getSettings(),a=`${t}:${n}`;if("firestore.googleapis.com"!==o.host&&o.host!==a&&bl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},o),{host:a,ssl:!1})),i.mockUserToken){let t,n;if("string"==typeof i.mockUserToken)t=i.mockUserToken,n=gl.MOCK_USER;else{t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",i=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[r(JSON.stringify({alg:"none",type:"JWT"})),r(JSON.stringify(o)),""].join(".")}(i.mockUserToken,null===(s=e._app)||void 0===s?void 0:s.options.projectId);const o=i.mockUserToken.sub||i.mockUserToken.user_id;if(!o)throw new Cl(Al.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new gl(o)}e._authCredentials=new Rl(new Nl(t,n))}}(n,...e)}return n}();document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("bilanganAhliKeluargaInput");e.addEventListener("change",(()=>{let t=document.getElementById("maklumatAhliKeluarga");t.innerHTML="";for(let n=0;n<e.value;n++){let e=document.createElement("div");e.classList.add("ahliKeluarga"),e.classList.add("field");let i=document.createElement("input");i.setAttribute("type","text"),i.setAttribute("placeholder","Nama Ahli Keluarga "+(n+1)),i.setAttribute("id","namaAhliKeluarga"+n),i.setAttribute("class","input");let r=document.createElement("input");r.setAttribute("type","text"),r.setAttribute("placeholder","No Kad Pengenalan Ahli Keluarga "+(n+1)),r.setAttribute("id","noKadPengenalanAhliKeluarga"+n),r.setAttribute("class","input");let s=document.createElement("input");s.setAttribute("type","text"),s.setAttribute("placeholder","Hubungan Ahli Keluarga "+(n+1)),s.setAttribute("id","hubunganAhliKeluarga"+n),s.setAttribute("class","input"),e.appendChild(i),e.appendChild(r),e.appendChild(s),t.appendChild(e)}}))}));const Fp=document.getElementById("registerForm");Fp.addEventListener("submit",(async e=>{e.preventDefault();const t=document.getElementById("nama").value,n=document.getElementById("noKadPengenalan").value,i=document.getElementById("emel").value,r=document.getElementById("noGaji").value,s=document.querySelector('input[name="statusPerkahwinan"]:checked').value;let o=[];const a=document.getElementById("bilanganAhliKeluargaInput");let c=[];for(let e=0;e<a.value;e++){let t={nama:document.getElementById("namaAhliKeluarga"+e).value,noKadPengenalan:document.getElementById("noKadPengenalanAhliKeluarga"+e).value,hubungan:document.getElementById("hubunganAhliKeluarga"+e).value};c.push(t)}try{const e={nama:t,noKadPengenalan:n,emel:i,noGaji:r,statusPerkahwinan:s,rekodImbuhan:o,ahliKeluargaLayak:c,bilanganAhliKeluarga:document.getElementById("bilanganAhliKeluargaInput").value},a=await Mp(function(e,t,...n){if(e=D(e),ip("collection","path",t),e instanceof lp){const i=zl.fromString(t,...n);return sp(i),new dp(e,null,i)}{if(!(e instanceof up||e instanceof dp))throw new Cl(Al.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(zl.fromString(t,...n));return sp(i),new dp(e.firestore,null,i)}}(xp,"pengguna"),e);console.log("New pengguna document ID:",a.id),Fp.reset(),setTimeout((function(){location.href="./admin.html"}),2e3)}catch(e){console.error("Error adding pengguna document:",e)}}))})();